{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/components/ThemeToggle.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"toggle\": \"ThemeToggle-module__3b5zuq__toggle\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA"}},
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/abhig/Downloads/zip-explorer1/components/ThemeToggle.tsx"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useState } from \"react\"\nimport styles from \"./ThemeToggle.module.css\"\n\nexport function ThemeToggle() {\n  const [isDark, setIsDark] = useState(false)\n  const [mounted, setMounted] = useState(false)\n\n  useEffect(() => {\n    setMounted(true)\n    const isDarkMode = document.documentElement.classList.contains(\"dark\")\n    setIsDark(isDarkMode)\n  }, [])\n\n  const toggleTheme = () => {\n    if (!mounted) return\n\n    const html = document.documentElement\n    const newIsDark = !isDark\n\n    if (newIsDark) {\n      html.classList.add(\"dark\")\n      localStorage.setItem(\"theme\", \"dark\")\n    } else {\n      html.classList.remove(\"dark\")\n      localStorage.setItem(\"theme\", \"light\")\n    }\n\n    setIsDark(newIsDark)\n  }\n\n  if (!mounted) return null\n\n  return (\n    <button\n      className={styles.toggle}\n      onClick={toggleTheme}\n      title={isDark ? \"Switch to light mode\" : \"Switch to dark mode\"}\n      aria-label=\"Toggle theme\"\n    >\n      {isDark ? (\n        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n          <circle cx=\"12\" cy=\"12\" r=\"5\" />\n          <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"3\" />\n          <line x1=\"12\" y1=\"21\" x2=\"12\" y2=\"23\" />\n          <line x1=\"4.22\" y1=\"4.22\" x2=\"5.64\" y2=\"5.64\" />\n          <line x1=\"18.36\" y1=\"18.36\" x2=\"19.78\" y2=\"19.78\" />\n          <line x1=\"1\" y1=\"12\" x2=\"3\" y2=\"12\" />\n          <line x1=\"21\" y1=\"12\" x2=\"23\" y2=\"12\" />\n          <line x1=\"4.22\" y1=\"19.78\" x2=\"5.64\" y2=\"18.36\" />\n          <line x1=\"18.36\" y1=\"5.64\" x2=\"19.78\" y2=\"4.22\" />\n        </svg>\n      ) : (\n        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n          <path d=\"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z\" />\n        </svg>\n      )}\n    </button>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKO,SAAS;IACd,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACR,WAAW;QACX,MAAM,aAAa,SAAS,eAAe,CAAC,SAAS,CAAC,QAAQ,CAAC;QAC/D,UAAU;IACZ,GAAG,EAAE;IAEL,MAAM,cAAc;QAClB,IAAI,CAAC,SAAS;QAEd,MAAM,OAAO,SAAS,eAAe;QACrC,MAAM,YAAY,CAAC;QAEnB,IAAI,WAAW;YACb,KAAK,SAAS,CAAC,GAAG,CAAC;YACnB,aAAa,OAAO,CAAC,SAAS;QAChC,OAAO;YACL,KAAK,SAAS,CAAC,MAAM,CAAC;YACtB,aAAa,OAAO,CAAC,SAAS;QAChC;QAEA,UAAU;IACZ;IAEA,IAAI,CAAC,SAAS,OAAO;IAErB,qBACE,8OAAC;QACC,WAAW,gJAAM,CAAC,MAAM;QACxB,SAAS;QACT,OAAO,SAAS,yBAAyB;QACzC,cAAW;kBAEV,uBACC,8OAAC;YAAI,OAAM;YAAK,QAAO;YAAK,SAAQ;YAAY,MAAK;YAAO,QAAO;YAAe,aAAY;;8BAC5F,8OAAC;oBAAO,IAAG;oBAAK,IAAG;oBAAK,GAAE;;;;;;8BAC1B,8OAAC;oBAAK,IAAG;oBAAK,IAAG;oBAAI,IAAG;oBAAK,IAAG;;;;;;8BAChC,8OAAC;oBAAK,IAAG;oBAAK,IAAG;oBAAK,IAAG;oBAAK,IAAG;;;;;;8BACjC,8OAAC;oBAAK,IAAG;oBAAO,IAAG;oBAAO,IAAG;oBAAO,IAAG;;;;;;8BACvC,8OAAC;oBAAK,IAAG;oBAAQ,IAAG;oBAAQ,IAAG;oBAAQ,IAAG;;;;;;8BAC1C,8OAAC;oBAAK,IAAG;oBAAI,IAAG;oBAAK,IAAG;oBAAI,IAAG;;;;;;8BAC/B,8OAAC;oBAAK,IAAG;oBAAK,IAAG;oBAAK,IAAG;oBAAK,IAAG;;;;;;8BACjC,8OAAC;oBAAK,IAAG;oBAAO,IAAG;oBAAQ,IAAG;oBAAO,IAAG;;;;;;8BACxC,8OAAC;oBAAK,IAAG;oBAAQ,IAAG;oBAAO,IAAG;oBAAQ,IAAG;;;;;;;;;;;iCAG3C,8OAAC;YAAI,OAAM;YAAK,QAAO;YAAK,SAAQ;YAAY,MAAK;YAAO,QAAO;YAAe,aAAY;sBAC5F,cAAA,8OAAC;gBAAK,GAAE;;;;;;;;;;;;;;;;AAKlB"}},
    {"offset": {"line": 178, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/components/UploadArea.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"button\": \"UploadArea-module__IZzUWW__button\",\n  \"container\": \"UploadArea-module__IZzUWW__container\",\n  \"loading\": \"UploadArea-module__IZzUWW__loading\",\n  \"spin\": \"UploadArea-module__IZzUWW__spin\",\n  \"spinner\": \"UploadArea-module__IZzUWW__spinner\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 189, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/abhig/Downloads/zip-explorer1/components/UploadArea.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\n\nimport { useRef } from \"react\"\nimport styles from \"./UploadArea.module.css\"\n\ninterface UploadAreaProps {\n  onUpload: (file: File) => void\n  isLoading: boolean\n}\n\nexport function UploadArea({ onUpload, isLoading }: UploadAreaProps) {\n  const fileInputRef = useRef<HTMLInputElement>(null)\n\n  const handleFileSelect = (files: FileList | null) => {\n    if (!files || files.length === 0) return\n    const file = files[0]\n\n    if (!file.name.endsWith(\".zip\")) {\n      alert(\"Please select a .zip file\")\n      return\n    }\n\n    onUpload(file)\n  }\n\n  const handleClick = () => {\n    fileInputRef.current?.click()\n  }\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    handleFileSelect(e.target.files)\n  }\n\n  const handleDragOver = (e: React.DragEvent<HTMLDivElement>) => {\n    e.preventDefault()\n    e.stopPropagation()\n  }\n\n  const handleDragLeave = (e: React.DragEvent<HTMLDivElement>) => {\n    e.preventDefault()\n    e.stopPropagation()\n  }\n\n  const handleDrop = (e: React.DragEvent<HTMLDivElement>) => {\n    e.preventDefault()\n    e.stopPropagation()\n    handleFileSelect(e.dataTransfer.files)\n  }\n\n  return (\n    <div\n      className={`${styles.container} ${isLoading ? styles.loading : \"\"}`}\n      onDragOver={handleDragOver}\n      onDragLeave={handleDragLeave}\n      onDrop={handleDrop}\n    >\n      <button\n        className={styles.button}\n        onClick={handleClick}\n        disabled={isLoading}\n        title=\"Click to upload or drag and drop a .zip file\"\n      >\n        {isLoading ? (\n          <>\n            <span className={styles.spinner} />\n            Uploading...\n          </>\n        ) : (\n          <>\n            <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n              <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\n              <polyline points=\"17 8 12 3 7 8\" />\n              <line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\" />\n            </svg>\n            <span>Upload ZIP File</span>\n          </>\n        )}\n      </button>\n      <input\n        ref={fileInputRef}\n        type=\"file\"\n        accept=\".zip\"\n        onChange={handleInputChange}\n        style={{ display: \"none\" }}\n        disabled={isLoading}\n      />\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAIA;AACA;AALA;;;;AAYO,SAAS,WAAW,EAAE,QAAQ,EAAE,SAAS,EAAmB;IACjE,MAAM,eAAe,IAAA,+MAAM,EAAmB;IAE9C,MAAM,mBAAmB,CAAC;QACxB,IAAI,CAAC,SAAS,MAAM,MAAM,KAAK,GAAG;QAClC,MAAM,OAAO,KAAK,CAAC,EAAE;QAErB,IAAI,CAAC,KAAK,IAAI,CAAC,QAAQ,CAAC,SAAS;YAC/B,MAAM;YACN;QACF;QAEA,SAAS;IACX;IAEA,MAAM,cAAc;QAClB,aAAa,OAAO,EAAE;IACxB;IAEA,MAAM,oBAAoB,CAAC;QACzB,iBAAiB,EAAE,MAAM,CAAC,KAAK;IACjC;IAEA,MAAM,iBAAiB,CAAC;QACtB,EAAE,cAAc;QAChB,EAAE,eAAe;IACnB;IAEA,MAAM,kBAAkB,CAAC;QACvB,EAAE,cAAc;QAChB,EAAE,eAAe;IACnB;IAEA,MAAM,aAAa,CAAC;QAClB,EAAE,cAAc;QAChB,EAAE,eAAe;QACjB,iBAAiB,EAAE,YAAY,CAAC,KAAK;IACvC;IAEA,qBACE,8OAAC;QACC,WAAW,GAAG,+IAAM,CAAC,SAAS,CAAC,CAAC,EAAE,YAAY,+IAAM,CAAC,OAAO,GAAG,IAAI;QACnE,YAAY;QACZ,aAAa;QACb,QAAQ;;0BAER,8OAAC;gBACC,WAAW,+IAAM,CAAC,MAAM;gBACxB,SAAS;gBACT,UAAU;gBACV,OAAM;0BAEL,0BACC;;sCACE,8OAAC;4BAAK,WAAW,+IAAM,CAAC,OAAO;;;;;;wBAAI;;iDAIrC;;sCACE,8OAAC;4BAAI,OAAM;4BAAK,QAAO;4BAAK,SAAQ;4BAAY,MAAK;4BAAO,QAAO;4BAAe,aAAY;;8CAC5F,8OAAC;oCAAK,GAAE;;;;;;8CACR,8OAAC;oCAAS,QAAO;;;;;;8CACjB,8OAAC;oCAAK,IAAG;oCAAK,IAAG;oCAAI,IAAG;oCAAK,IAAG;;;;;;;;;;;;sCAElC,8OAAC;sCAAK;;;;;;;;;;;;;0BAIZ,8OAAC;gBACC,KAAK;gBACL,MAAK;gBACL,QAAO;gBACP,UAAU;gBACV,OAAO;oBAAE,SAAS;gBAAO;gBACzB,UAAU;;;;;;;;;;;;AAIlB"}},
    {"offset": {"line": 330, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/components/UserMenu.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"dropdown\": \"UserMenu-module__pCivJG__dropdown\",\n  \"loginBtn\": \"UserMenu-module__pCivJG__loginBtn\",\n  \"menuItem\": \"UserMenu-module__pCivJG__menuItem\",\n  \"userBtn\": \"UserMenu-module__pCivJG__userBtn\",\n  \"userMenu\": \"UserMenu-module__pCivJG__userMenu\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 341, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/abhig/Downloads/zip-explorer1/components/UserMenu.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { signOut, useSession } from \"next-auth/react\"\r\nimport Link from \"next/link\"\r\nimport { useState } from \"react\"\r\nimport styles from \"./UserMenu.module.css\"\r\n\r\nexport function UserMenu() {\r\n  const { data: session, status } = useSession()\r\n  const [showMenu, setShowMenu] = useState(false)\r\n\r\n  // Determine userTier based on session data\r\n  let userTier: \"anonymous\" | \"free\" | \"monthly\" | \"yearly\" = \"anonymous\";\r\n\r\n  if (status === \"authenticated\" && session?.user) {\r\n    // Use the actual subscriptionPlan from the session, defaulting to 'free' if not set\r\n    const plan = session.user.subscriptionPlan || \"free\";\r\n    // Ensure the tier is one of the expected values\r\n    if ([\"free\", \"monthly\", \"yearly\"].includes(plan)) {\r\n      userTier = plan as \"free\" | \"monthly\" | \"yearly\";\r\n    } else {\r\n      userTier = \"free\"; // Fallback to 'free' for unknown or invalid plans\r\n    }\r\n  }\r\n\r\n  // Display nothing while loading the session\r\n  if (status === \"loading\") {\r\n    return null\r\n  }\r\n\r\n  // Display Sign In link if not authenticated\r\n  if (!session) {\r\n    return (\r\n      <Link href=\"/login\" className={styles.loginBtn}>\r\n        Sign In\r\n      </Link>\r\n    )\r\n  }\r\n\r\n  // Display User Menu if authenticated\r\n  return (\r\n    <div className={styles.userMenu}>\r\n      <button className={styles.userBtn} onClick={() => setShowMenu(!showMenu)}>\r\n        üë§ {session.user?.name || \"User\"}\r\n      </button>\r\n\r\n      {showMenu && (\r\n        <div className={styles.dropdown}>\r\n          <Link href=\"/dashboard\" className={styles.menuItem}>\r\n            Dashboard\r\n          </Link>\r\n          <Link href=\"/billing\" className={styles.menuItem}>\r\n            Billing ({userTier})\r\n          </Link>\r\n          <button className={styles.menuItem} onClick={() => signOut()}>\r\n            Sign Out\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOO,SAAS;IACd,MAAM,EAAE,MAAM,OAAO,EAAE,MAAM,EAAE,GAAG,IAAA,4JAAU;IAC5C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IAEzC,2CAA2C;IAC3C,IAAI,WAAwD;IAE5D,IAAI,WAAW,mBAAmB,SAAS,MAAM;QAC/C,oFAAoF;QACpF,MAAM,OAAO,QAAQ,IAAI,CAAC,gBAAgB,IAAI;QAC9C,gDAAgD;QAChD,IAAI;YAAC;YAAQ;YAAW;SAAS,CAAC,QAAQ,CAAC,OAAO;YAChD,WAAW;QACb,OAAO;YACL,WAAW,QAAQ,kDAAkD;QACvE;IACF;IAEA,4CAA4C;IAC5C,IAAI,WAAW,WAAW;QACxB,OAAO;IACT;IAEA,4CAA4C;IAC5C,IAAI,CAAC,SAAS;QACZ,qBACE,8OAAC,uKAAI;YAAC,MAAK;YAAS,WAAW,6IAAM,CAAC,QAAQ;sBAAE;;;;;;IAIpD;IAEA,qCAAqC;IACrC,qBACE,8OAAC;QAAI,WAAW,6IAAM,CAAC,QAAQ;;0BAC7B,8OAAC;gBAAO,WAAW,6IAAM,CAAC,OAAO;gBAAE,SAAS,IAAM,YAAY,CAAC;;oBAAW;oBACpE,QAAQ,IAAI,EAAE,QAAQ;;;;;;;YAG3B,0BACC,8OAAC;gBAAI,WAAW,6IAAM,CAAC,QAAQ;;kCAC7B,8OAAC,uKAAI;wBAAC,MAAK;wBAAa,WAAW,6IAAM,CAAC,QAAQ;kCAAE;;;;;;kCAGpD,8OAAC,uKAAI;wBAAC,MAAK;wBAAW,WAAW,6IAAM,CAAC,QAAQ;;4BAAE;4BACtC;4BAAS;;;;;;;kCAErB,8OAAC;wBAAO,WAAW,6IAAM,CAAC,QAAQ;wBAAE,SAAS,IAAM,IAAA,yJAAO;kCAAI;;;;;;;;;;;;;;;;;;AAOxE"}},
    {"offset": {"line": 457, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/components/DownloadMenu.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"downloadBtn\": \"DownloadMenu-module__obcEYa__downloadBtn\",\n  \"downloadContainer\": \"DownloadMenu-module__obcEYa__downloadContainer\",\n  \"limitNotice\": \"DownloadMenu-module__obcEYa__limitNotice\",\n  \"saveBtn\": \"DownloadMenu-module__obcEYa__saveBtn\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 467, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/abhig/Downloads/zip-explorer1/components/DownloadMenu.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { toast } from \"sonner\";\r\nimport styles from \"./DownloadMenu.module.css\";\r\n\r\ninterface DownloadMenuProps {\r\n  selectedFilePaths: string[];\r\n  sessionId: string;\r\n  userTier: \"anonymous\" | \"free\" | \"monthly\" | \"yearly\" | string;\r\n}\r\n\r\nexport function DownloadMenu({\r\n  selectedFilePaths,\r\n  sessionId,\r\n  userTier,\r\n}: DownloadMenuProps) {\r\n  const [isDownloading, setIsDownloading] = useState(false);\r\n  const [isSaving, setIsSaving] = useState(false);\r\n\r\n  // Validate plan type\r\n  const effectiveTier = [\"anonymous\", \"free\", \"monthly\", \"yearly\"].includes(userTier)\r\n    ? (userTier as \"anonymous\" | \"free\" | \"monthly\" | \"yearly\")\r\n    : \"free\";\r\n\r\n  // Download permission rules\r\n  const canDownload = {\r\n    anonymous: false,\r\n    free: selectedFilePaths.length <= 10,\r\n    monthly: true,\r\n    yearly: true,\r\n  }[effectiveTier];\r\n\r\n  const handleDownload = async (downloadType: \"individual\" | \"zip\") => {\r\n    if (!canDownload) {\r\n      toast.error(\"Your plan does not allow downloads. Please upgrade.\");\r\n      return;\r\n    }\r\n\r\n    if (!selectedFilePaths.length) {\r\n      toast.error(\"Please select files.\");\r\n      return;\r\n    }\r\n\r\n    setIsDownloading(true);\r\n    try {\r\n      const res = await fetch(\"/api/files/download\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          sessionId,\r\n          files: selectedFilePaths,\r\n          downloadType,\r\n          userTier: effectiveTier,\r\n        }),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        toast.error(\"Download failed.\");\r\n        return;\r\n      }\r\n\r\n      const blob = await res.blob();\r\n      let filename = \"files.zip\";\r\n\r\n      if (downloadType === \"individual\" && selectedFilePaths.length === 1) {\r\n        filename = selectedFilePaths[0].split(\"/\").pop() || \"file\";\r\n      }\r\n\r\n      const url = window.URL.createObjectURL(blob);\r\n      const a = document.createElement(\"a\");\r\n      a.href = url;\r\n      a.download = filename;\r\n      a.click();\r\n      window.URL.revokeObjectURL(url);\r\n\r\n      toast.success(\"Download started!\");\r\n    } finally {\r\n      setIsDownloading(false);\r\n    }\r\n  };\r\n\r\n  // SAVE ZIP (monthly / yearly only)\r\n  const handleSaveZip = async () => {\r\n    if (effectiveTier !== \"monthly\" && effectiveTier !== \"yearly\") {\r\n      toast.error(\"Upgrade plan to save ZIP folders.\");\r\n      return;\r\n    }\r\n\r\n    if (!selectedFilePaths.length) {\r\n      toast.error(\"No files selected.\");\r\n      return;\r\n    }\r\n\r\n    setIsSaving(true);\r\n    try {\r\n      const files = selectedFilePaths.map((path) => ({\r\n        path,\r\n        content: sessionStorage.getItem(path) || \"\",\r\n      }));\r\n\r\n      const res = await fetch(\"/api/save-zip\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          zipName: `saved-${Date.now()}`,\r\n          files,\r\n        }),\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (!res.ok) {\r\n        toast.error(data.error || \"Failed to save ZIP\");\r\n        return;\r\n      }\r\n\r\n      toast.success(\"ZIP saved successfully!\");\r\n    } finally {\r\n      setIsSaving(false);\r\n    }\r\n  };\r\n\r\n  const multiple = selectedFilePaths.length > 1;\r\n\r\n  return (\r\n    <div className={styles.downloadContainer}>\r\n      {/* Download ZIP / FILE */}\r\n      <button\r\n        className={styles.downloadBtn}\r\n        onClick={() => handleDownload(multiple ? \"zip\" : \"individual\")}\r\n        disabled={!canDownload || isDownloading}\r\n      >\r\n        {isDownloading ? \"‚¨áÔ∏è Downloading...\" : multiple ? \"‚¨áÔ∏è Download ZIP\" : \"‚¨áÔ∏è Download File\"}\r\n      </button>\r\n\r\n      {/* SAVE ZIP ‚Üí only monthly + yearly */}\r\n      {(effectiveTier === \"monthly\" || effectiveTier === \"yearly\") && (\r\n        <button\r\n          className={styles.saveBtn}\r\n          onClick={handleSaveZip}\r\n          disabled={isSaving}\r\n        >\r\n          {isSaving ? \"üíæ Saving...\" : \"üíæ Save File\"}\r\n        </button>\r\n      )}\r\n\r\n      {/* FREE PLAN LIMIT WARNING */}\r\n      {effectiveTier === \"free\" && selectedFilePaths.length > 10 && (\r\n        <p className={styles.limitNotice}>\r\n          Free plan limited to 10 files. Upgrade for unlimited downloads.\r\n        </p>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 618, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/components/SaveHistoryButton.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"actions\": \"SaveHistoryButton-module__7aqaaq__actions\",\n  \"btn\": \"SaveHistoryButton-module__7aqaaq__btn\",\n  \"deleteBtn\": \"SaveHistoryButton-module__7aqaaq__deleteBtn\",\n  \"modal\": \"SaveHistoryButton-module__7aqaaq__modal\",\n  \"modalBody\": \"SaveHistoryButton-module__7aqaaq__modalBody\",\n  \"modalContent\": \"SaveHistoryButton-module__7aqaaq__modalContent\",\n  \"modalHeader\": \"SaveHistoryButton-module__7aqaaq__modalHeader\",\n  \"showModal\": \"SaveHistoryButton-module__7aqaaq__showModal\",\n  \"useBtn\": \"SaveHistoryButton-module__7aqaaq__useBtn\",\n  \"zipInfo\": \"SaveHistoryButton-module__7aqaaq__zipInfo\",\n  \"zipItem\": \"SaveHistoryButton-module__7aqaaq__zipItem\",\n  \"zipList\": \"SaveHistoryButton-module__7aqaaq__zipList\",\n  \"zipMeta\": \"SaveHistoryButton-module__7aqaaq__zipMeta\",\n  \"zipName\": \"SaveHistoryButton-module__7aqaaq__zipName\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 638, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/abhig/Downloads/zip-explorer1/components/SaveHistoryButton.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState } from \"react\"\r\nimport { toast } from \"sonner\"\r\nimport styles from \"./SaveHistoryButton.module.css\"\r\n\r\ninterface SaveHistoryButtonProps {\r\n  sessionId: string\r\n  onLoadSavedZip: (files: any[]) => void\r\n}\r\n\r\ninterface SavedZip {\r\n  _id: string\r\n  name: string\r\n  fileCount: number\r\n  blobUrl: string\r\n}\r\n\r\nexport function SaveHistoryButton({ sessionId, onLoadSavedZip }: SaveHistoryButtonProps) {\r\n  const [showModal, setShowModal] = useState(false)\r\n  const [savedZips, setSavedZips] = useState<SavedZip[]>([])\r\n  const [isLoading, setIsLoading] = useState(false)\r\n  const [isDeleting, setIsDeleting] = useState<string | null>(null) // To track which item is being deleted\r\n\r\n  const fetchSavedZips = async () => {\r\n    setIsLoading(true)\r\n    try {\r\n      const response = await fetch(\"/api/save-zip/list\")\r\n      const data = await response.json()\r\n      if (data.success) setSavedZips(data.savedZips)\r\n    } catch (e) {\r\n      toast.error(\"Failed to fetch saved history\")\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }\r\n\r\n  const handleUse = async (zip: SavedZip) => {\r\n    try {\r\n      const res = await fetch(\"/api/save-zip/load\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ url: zip.blobUrl }),\r\n      })\r\n\r\n      const data = await res.json()\r\n      if (!data.success) {\r\n        toast.error(\"Failed to open ZIP\")\r\n        return\r\n      }\r\n\r\n      onLoadSavedZip(data.files)\r\n      setShowModal(false)\r\n      toast.success(`Loaded '${zip.name}'`)\r\n    } catch {\r\n      toast.error(\"Error loading ZIP\")\r\n    }\r\n  }\r\n\r\n  const handleDelete = async (zip: SavedZip) => {\r\n    // Use a custom modal in a real app, but using window.confirm here to quickly add functionality\r\n    if (!window.confirm(`Are you sure you want to delete \"${zip.name}\"?`)) {\r\n      return\r\n    }\r\n\r\n    setIsDeleting(zip._id)\r\n    try {\r\n      const res = await fetch(\"/api/save-zip/delete\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ id: zip._id, url: zip.blobUrl }),\r\n      })\r\n\r\n      const data = await res.json()\r\n      if (data.success) {\r\n        toast.success(`Deleted '${zip.name}'`)\r\n        // Remove from local state\r\n        setSavedZips((prev) => prev.filter((z) => z._id !== zip._id))\r\n      } else {\r\n        toast.error(\"Failed to delete ZIP\")\r\n      }\r\n    } catch {\r\n      toast.error(\"Error deleting ZIP\")\r\n    } finally {\r\n      setIsDeleting(null)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <button\r\n        className={styles.btn}\r\n        onClick={() => {\r\n          setShowModal(true)\r\n          fetchSavedZips()\r\n        }}\r\n        title=\"View and Load Saved Folders\"\r\n      >\r\n        üíæ History\r\n      </button>\r\n\r\n      {showModal && (\r\n        <div className={styles.modal}>\r\n          <div className={styles.modalContent}>\r\n            <div className={styles.modalHeader}>\r\n              <h2>Saved ZIP Folders</h2>\r\n              <button onClick={() => setShowModal(false)}>√ó</button>\r\n            </div>\r\n\r\n            <div className={styles.modalBody}>\r\n              {isLoading ? (\r\n                <p>Loading...</p>\r\n              ) : savedZips.length === 0 ? (\r\n                <p>No saved ZIPs yet. Upload a folder (multiple files) to save its history.</p>\r\n              ) : (\r\n                <ul className={styles.zipList}>\r\n                  {savedZips.map((zip) => (\r\n                    <li key={zip._id} className={styles.zipItem}>\r\n                      <div className={styles.zipInfo}>\r\n                        <strong>{zip.name}</strong>\r\n                        <span>{zip.fileCount} files</span>\r\n                      </div>\r\n\r\n                      <div className={styles.actions}>\r\n                         <button\r\n                            className={styles.deleteBtn}\r\n                            onClick={() => handleDelete(zip)}\r\n                            disabled={isDeleting === zip._id || isDeleting !== null}\r\n                            title={`Delete ${zip.name}`}\r\n                         >\r\n                            {isDeleting === zip._id ? \"Deleting...\" : \"Delete\"}\r\n                         </button>\r\n                         <button\r\n                            className={styles.useBtn}\r\n                            onClick={() => handleUse(zip)}\r\n                            disabled={isDeleting !== null}\r\n                            title={`Load ${zip.name}`}\r\n                          >\r\n                            Use\r\n                          </button>\r\n                      </div>\r\n                    </li>\r\n                  ))}\r\n                </ul>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 876, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/components/TopBar.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"accessBtn\": \"TopBar-module__dQ673a__accessBtn\",\n  \"label\": \"TopBar-module__dQ673a__label\",\n  \"left\": \"TopBar-module__dQ673a__left\",\n  \"logo\": \"TopBar-module__dQ673a__logo\",\n  \"middle\": \"TopBar-module__dQ673a__middle\",\n  \"right\": \"TopBar-module__dQ673a__right\",\n  \"saveBtn\": \"TopBar-module__dQ673a__saveBtn\",\n  \"shareBtn\": \"TopBar-module__dQ673a__shareBtn\",\n  \"stats\": \"TopBar-module__dQ673a__stats\",\n  \"title\": \"TopBar-module__dQ673a__title\",\n  \"topbar\": \"TopBar-module__dQ673a__topbar\",\n  \"value\": \"TopBar-module__dQ673a__value\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 894, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/abhig/Downloads/zip-explorer1/components/TopBar.tsx"],"sourcesContent":["\"use client\"\n\nimport { ThemeToggle } from \"./ThemeToggle\"\nimport { UploadArea } from \"./UploadArea\"\nimport { UserMenu } from \"./UserMenu\"\nimport { DownloadMenu } from \"./DownloadMenu\"\nimport { SaveHistoryButton } from \"./SaveHistoryButton\"\nimport styles from \"./TopBar.module.css\"\nimport { useSession } from \"next-auth/react\"\nimport { useEffect, useState } from \"react\"\nimport { toast } from \"sonner\" // Import toast for save functionality\n\ninterface TopBarProps {\n  fileCount: number\n  onUpload: (file: File) => void\n  isLoading: boolean\n  selectedFilePaths: string[]\n  sessionId: string\n  onShareClick: () => void\n  onAccessSharedClick: () => void\n  files: { path: string; content: string }[] // Pass the list of files to save\n\n  // required for loading saved ZIP\n  onLoadSavedZip: (files: any[]) => void\n}\n\nexport function TopBar({\n  fileCount,\n  onUpload,\n  isLoading,\n  selectedFilePaths,\n  sessionId,\n  onShareClick,\n  onAccessSharedClick,\n  onLoadSavedZip, // Left in destructuring since it is used below in SaveHistoryButton\n  files, // New prop\n}: TopBarProps) {\n  \n  const { data: session, status } = useSession()\n\n  const [userTier, setUserTier] =\n    useState<\"anonymous\" | \"free\" | \"monthly\" | \"yearly\">(\"anonymous\")\n  const [isSaving, setIsSaving] = useState(false)\n\n  useEffect(() => {\n    if (status === \"loading\") return\n\n    if (!session?.user) {\n      setUserTier(\"anonymous\")\n      return\n    }\n\n    const plan = session.user.subscriptionPlan || \"free\"\n    setUserTier(plan as \"free\" | \"monthly\" | \"yearly\")\n  }, [session, status])\n\n  const handleSave = async () => {\n    // files.length will now be the full count of the uploaded zip\n    if (files.length < 2) { \n      toast.error(\"Please upload a folder (multiple files) to save.\")\n      return\n    }\n\n    const zipName = prompt(\"Enter a name for the saved ZIP folder:\")\n    if (!zipName) return\n\n    setIsSaving(true)\n    try {\n      // This fetch uses the `files` prop, which now contains ALL file contents.\n      const res = await fetch(\"/api/save-zip\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ zipName, files }),\n      })\n\n      const data = await res.json()\n      if (data.success) {\n        toast.success(`Folder '${zipName}' saved successfully!`)\n      } else {\n        toast.error(data.error || \"Failed to save ZIP\")\n      }\n    } catch {\n      toast.error(\"Error saving ZIP\")\n    } finally {\n      setIsSaving(false)\n    }\n  }\n\n  // Use files.length instead of fileCount for the save check, \n  // though they should be the same after the fix in page.tsx\n  const canSave = (userTier === \"monthly\" || userTier === \"yearly\") && files.length > 1\n\n  return (\n    <header className={styles.topbar}>\n      <div className={styles.left}>\n        <div className={styles.logo}>\n          <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\">\n            <path d=\"M12 2l.5 1h6.5a1 1 0 0 1 1 1v3H4V4a1 1 0 0 1 1-1h6.5l.5-1\" />\n            <rect x=\"4\" y=\"5\" width=\"16\" height=\"14\" rx=\"1\" />\n            <path d=\"M8 9h8M8 13h8M8 17h4\" strokeOpacity=\"0.5\" />\n          </svg>\n          <h1 className={styles.title}>Code Explorer</h1>\n        </div>\n      </div>\n\n      <div className={styles.middle}>\n        <UploadArea onUpload={onUpload} isLoading={isLoading} />\n      </div>\n\n      <div className={styles.right}>\n        <div className={styles.stats}>\n          <span className={styles.label}>Files:</span>\n          <span className={styles.value}>{fileCount}</span>\n        </div>\n\n        {selectedFilePaths.length > 0 && (\n          <>\n            <DownloadMenu\n              selectedFilePaths={selectedFilePaths}\n              sessionId={sessionId}\n              userTier={userTier}\n            />\n\n            <button\n              className={styles.shareBtn}\n              onClick={onShareClick}\n              title=\"Share files with PIN\"\n            >\n              üì§ Share\n            </button>\n          </>\n        )}\n\n        {/* NEW: Save Button visible only if pro/premium AND fileCount > 1 */}\n        {canSave && (\n          <button\n            className={styles.saveBtn}\n            onClick={handleSave}\n            disabled={isSaving}\n            title=\"Save the currently loaded folder\"\n          >\n            {isSaving ? \"Saving...\" : \"‚≠ê Save Folder\"}\n          </button>\n        )}\n        \n        {(userTier === \"monthly\" || userTier === \"yearly\") && (\n          <SaveHistoryButton\n            sessionId={sessionId}\n            onLoadSavedZip={onLoadSavedZip}\n          />\n        )}\n\n        <button\n          className={styles.accessBtn}\n          onClick={onAccessSharedClick}\n          title=\"Access shared files\"\n        >\n          üîì Access Shared\n        </button>\n\n        <ThemeToggle />\n        <UserMenu />\n      </div>\n    </header>\n  )\n}"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+OAA+B,sCAAsC;AAVrE;;;;;;;;;;;AA0BO,SAAS,OAAO,EACrB,SAAS,EACT,QAAQ,EACR,SAAS,EACT,iBAAiB,EACjB,SAAS,EACT,YAAY,EACZ,mBAAmB,EACnB,cAAc,EACd,KAAK,EACO;IAEZ,MAAM,EAAE,MAAM,OAAO,EAAE,MAAM,EAAE,GAAG,IAAA,4JAAU;IAE5C,MAAM,CAAC,UAAU,YAAY,GAC3B,IAAA,iNAAQ,EAA8C;IACxD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IAEzC,IAAA,kNAAS,EAAC;QACR,IAAI,WAAW,WAAW;QAE1B,IAAI,CAAC,SAAS,MAAM;YAClB,YAAY;YACZ;QACF;QAEA,MAAM,OAAO,QAAQ,IAAI,CAAC,gBAAgB,IAAI;QAC9C,YAAY;IACd,GAAG;QAAC;QAAS;KAAO;IAEpB,MAAM,aAAa;QACjB,8DAA8D;QAC9D,IAAI,MAAM,MAAM,GAAG,GAAG;YACpB,iJAAK,CAAC,KAAK,CAAC;YACZ;QACF;QAEA,MAAM,UAAU,OAAO;QACvB,IAAI,CAAC,SAAS;QAEd,YAAY;QACZ,IAAI;YACF,0EAA0E;YAC1E,MAAM,MAAM,MAAM,MAAM,iBAAiB;gBACvC,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAS;gBAAM;YACxC;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,IAAI,KAAK,OAAO,EAAE;gBAChB,iJAAK,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,QAAQ,qBAAqB,CAAC;YACzD,OAAO;gBACL,iJAAK,CAAC,KAAK,CAAC,KAAK,KAAK,IAAI;YAC5B;QACF,EAAE,OAAM;YACN,iJAAK,CAAC,KAAK,CAAC;QACd,SAAU;YACR,YAAY;QACd;IACF;IAEA,6DAA6D;IAC7D,2DAA2D;IAC3D,MAAM,UAAU,CAAC,aAAa,aAAa,aAAa,QAAQ,KAAK,MAAM,MAAM,GAAG;IAEpF,qBACE,8OAAC;QAAO,WAAW,2IAAM,CAAC,MAAM;;0BAC9B,8OAAC;gBAAI,WAAW,2IAAM,CAAC,IAAI;0BACzB,cAAA,8OAAC;oBAAI,WAAW,2IAAM,CAAC,IAAI;;sCACzB,8OAAC;4BAAI,OAAM;4BAAK,QAAO;4BAAK,SAAQ;4BAAY,MAAK;4BAAO,QAAO;4BAAe,aAAY;;8CAC5F,8OAAC;oCAAK,GAAE;;;;;;8CACR,8OAAC;oCAAK,GAAE;oCAAI,GAAE;oCAAI,OAAM;oCAAK,QAAO;oCAAK,IAAG;;;;;;8CAC5C,8OAAC;oCAAK,GAAE;oCAAuB,eAAc;;;;;;;;;;;;sCAE/C,8OAAC;4BAAG,WAAW,2IAAM,CAAC,KAAK;sCAAE;;;;;;;;;;;;;;;;;0BAIjC,8OAAC;gBAAI,WAAW,2IAAM,CAAC,MAAM;0BAC3B,cAAA,8OAAC,uIAAU;oBAAC,UAAU;oBAAU,WAAW;;;;;;;;;;;0BAG7C,8OAAC;gBAAI,WAAW,2IAAM,CAAC,KAAK;;kCAC1B,8OAAC;wBAAI,WAAW,2IAAM,CAAC,KAAK;;0CAC1B,8OAAC;gCAAK,WAAW,2IAAM,CAAC,KAAK;0CAAE;;;;;;0CAC/B,8OAAC;gCAAK,WAAW,2IAAM,CAAC,KAAK;0CAAG;;;;;;;;;;;;oBAGjC,kBAAkB,MAAM,GAAG,mBAC1B;;0CACE,8OAAC,2IAAY;gCACX,mBAAmB;gCACnB,WAAW;gCACX,UAAU;;;;;;0CAGZ,8OAAC;gCACC,WAAW,2IAAM,CAAC,QAAQ;gCAC1B,SAAS;gCACT,OAAM;0CACP;;;;;;;;oBAOJ,yBACC,8OAAC;wBACC,WAAW,2IAAM,CAAC,OAAO;wBACzB,SAAS;wBACT,UAAU;wBACV,OAAM;kCAEL,WAAW,cAAc;;;;;;oBAI7B,CAAC,aAAa,aAAa,aAAa,QAAQ,mBAC/C,8OAAC,qJAAiB;wBAChB,WAAW;wBACX,gBAAgB;;;;;;kCAIpB,8OAAC;wBACC,WAAW,2IAAM,CAAC,SAAS;wBAC3B,SAAS;wBACT,OAAM;kCACP;;;;;;kCAID,8OAAC,yIAAW;;;;;kCACZ,8OAAC,mIAAQ;;;;;;;;;;;;;;;;;AAIjB"}},
    {"offset": {"line": 1159, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/components/FileTree.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"checkbox\": \"FileTree-module__b3B1pW__checkbox\",\n  \"checkboxWrapper\": \"FileTree-module__b3B1pW__checkboxWrapper\",\n  \"children\": \"FileTree-module__b3B1pW__children\",\n  \"container\": \"FileTree-module__b3B1pW__container\",\n  \"expanded\": \"FileTree-module__b3B1pW__expanded\",\n  \"fileLabel\": \"FileTree-module__b3B1pW__fileLabel\",\n  \"folderLabel\": \"FileTree-module__b3B1pW__folderLabel\",\n  \"indentationLine\": \"FileTree-module__b3B1pW__indentationLine\",\n  \"label\": \"FileTree-module__b3B1pW__label\",\n  \"name\": \"FileTree-module__b3B1pW__name\",\n  \"nodeContent\": \"FileTree-module__b3B1pW__nodeContent\",\n  \"nodeWrapper\": \"FileTree-module__b3B1pW__nodeWrapper\",\n  \"selected\": \"FileTree-module__b3B1pW__selected\",\n  \"toggle\": \"FileTree-module__b3B1pW__toggle\",\n  \"toggleIcon\": \"FileTree-module__b3B1pW__toggleIcon\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 1180, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/abhig/Downloads/zip-explorer1/components/FileTree.tsx"],"sourcesContent":["// FileTree.tsx\n\n\"use client\"\n\nimport type React from \"react\"\nimport { useState, useCallback } from \"react\"\nimport type { FileNode } from \"@/app/actions\"\nimport styles from \"./FileTree.module.css\"\n\ninterface FileTreeProps {\n  tree: FileNode\n  onFileSelect: (path: string) => void\n  selectedFiles: Set<string>\n}\n\nexport function FileTree({ tree, onFileSelect, selectedFiles }: FileTreeProps) {\n  // Start with root expanded\n  const [expandedFolders, setExpandedFolders] = useState<Set<string>>(new Set([\".\"]))\n\n  const toggleFolder = useCallback((folderPath: string) => {\n    setExpandedFolders((prev) => {\n      const next = new Set(prev)\n      if (next.has(folderPath)) {\n        next.delete(folderPath)\n      } else {\n        next.add(folderPath)\n      }\n      return next\n    })\n  }, [])\n\n  return (\n    <div className={styles.container}>\n      <FileTreeNode\n        node={tree}\n        expandedFolders={expandedFolders}\n        toggleFolder={toggleFolder}\n        onFileSelect={onFileSelect}\n        selectedFiles={selectedFiles}\n        depth={0}\n      />\n    </div>\n  )\n}\n\ninterface FileTreeNodeProps {\n  node: FileNode\n  expandedFolders: Set<string>\n  toggleFolder: (path: string) => void\n  onFileSelect: (path: string) => void\n  selectedFiles: Set<string>\n  depth: number\n}\n\nfunction FileTreeNode({ node, expandedFolders, toggleFolder, onFileSelect, selectedFiles, depth }: FileTreeNodeProps) {\n  const isExpanded = expandedFolders.has(node.path)\n  const isFile = node.type === \"file\"\n  const isRoot = depth === 0\n\n  // Check if file is selected (used for coloring the label)\n  const isSelected = selectedFiles.has(node.path)\n\n  // Root node doesn't need indentation\n  const paddingLeft = isRoot ? 0 : `${depth * 16}px`\n  // Line offset for visual guide\n  const lineOffset = isRoot ? 0 : `${(depth - 1) * 16 + 8}px`\n\n\n  const handleToggle = () => {\n    if (!isFile) {\n      toggleFolder(node.path)\n    }\n  }\n\n  const handleCheckboxChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    e.stopPropagation()\n    if (isFile) {\n      onFileSelect(node.path)\n    }\n  }\n\n  return (\n    <div className={styles.nodeWrapper}>\n      {/* Visual indentation line for nested folders, starts one level above current depth */}\n      {depth > 1 && !isRoot && (\n        <div\n          className={styles.indentationLine}\n          style={{ left: lineOffset }}\n        />\n      )}\n      <div className={styles.nodeContent} style={{ paddingLeft }}>\n\n        {/* Toggle/Checkbox Area */}\n        {!isFile && node.children && node.children.length > 0 && (\n          <button className={styles.toggle} onClick={handleToggle} aria-label={isExpanded ? \"Collapse\" : \"Expand\"}>\n            <svg\n              className={`${styles.toggleIcon} ${isExpanded ? styles.expanded : \"\"}`}\n              viewBox=\"0 0 16 16\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              strokeWidth=\"2\"\n            >\n              {/* Simple chevron pointing right/down */}\n              <path d=\"M6 4l4 4-4 4\" />\n            </svg>\n          </button>\n        )}\n        {/* Spacer for non-folder items to align with toggles */}\n        {!isFile && node.children && node.children.length === 0 && <div style={{ width: '20px', marginRight: '4px' }}></div>}\n        {isFile && (\n          <div className={styles.checkboxWrapper}>\n            <input\n              type=\"checkbox\"\n              className={styles.checkbox}\n              onChange={handleCheckboxChange}\n              checked={isSelected}\n              id={`file-${node.path}`}\n            />\n          </div>\n        )}\n        {/* Label */}\n        <label\n          htmlFor={isFile ? `file-${node.path}` : undefined}\n          className={`${styles.label} ${isFile ? styles.fileLabel : styles.folderLabel} ${isSelected ? styles.selected : \"\"\n            }`}\n          onClick={isFile ? undefined : handleToggle} // Only folders toggle on label click\n        >\n          {getFileIcon(node.name, isFile, isExpanded)}\n          <span className={styles.name}>{node.name}</span>\n        </label>\n      </div>\n      {!isFile && isExpanded && node.children && (\n        <div className={styles.children}>\n          {node.children.map((child) => (\n            <FileTreeNode\n              key={child.path}\n              node={child}\n              expandedFolders={expandedFolders}\n              toggleFolder={toggleFolder}\n              onFileSelect={onFileSelect}\n              selectedFiles={selectedFiles}\n              depth={depth + 1}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}\n\n// Updated function to return a React node (SVG) instead of an emoji string\nfunction getFileIcon(filename: string, isFile: boolean, isExpanded: boolean): React.ReactNode {\n  if (!isFile) {\n    // Folder Icon\n    return (\n      <svg\n        width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\"\n        stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"\n        style={{ color: 'var(--color-accent)' }}\n      >\n        {/* Differentiate between open and closed folders */}\n        <path d={isExpanded ? \"M4 10.5V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.5a2 2 0 0 0-2-2h-8.5L9 5H6a2 2 0 0 0-2 2v3.5z\" : \"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 8.87 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2z\"} />\n      </svg>\n    );\n  }\n\n  // File Icons (using simple icons for popular file types)\n  const ext = filename.split(\".\").pop()?.toLowerCase()\n  const iconMap: { [key: string]: React.ReactNode } = {\n    // TS/JS/React Icons\n    js: <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#f0db4f\" strokeWidth=\"2\"><circle cx=\"12\" cy=\"12\" r=\"10\" /><path d=\"M12 7v5h5\" stroke=\"#323330\" /></svg>,\n    ts: <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#007acc\" strokeWidth=\"2\"><path d=\"M12 2L2 7l10 5 10-5L12 2zM2 17l10 5 10-5M2 12l10 5 10-5\" /></svg>,\n    tsx: <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#61dafb\" strokeWidth=\"2\"><path d=\"M12 2L2 7l10 5 10-5L12 2zM2 17l10 5 10-5M2 12l10 5 10-5\" /></svg>,\n    jsx: <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#61dafb\" strokeWidth=\"2\"><circle cx=\"12\" cy=\"12\" r=\"10\" /><path d=\"M9 12h6M12 9v6\" /></svg>,\n    // Config/Markup/Style Icons\n    json: <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#ff7b34\" strokeWidth=\"2\"><path d=\"M12 18V6M9 9l3-3 3 3M9 15l3 3 3-3\" /></svg>,\n    css: <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#1572b6\" strokeWidth=\"2\"><path d=\"M2 3h20v18H2zM12 7l-2 9-2-9h8\" /></svg>,\n    html: <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#e34f26\" strokeWidth=\"2\"><path d=\"M2 3h20v18H2zM12 7l-2 9-2-9h8\" /></svg>,\n    md: <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#ffffff\" strokeWidth=\"2\"><path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8zM14 2v6h6M9 14l2 2 4-4\" /></svg>,\n    // Generic/Default\n    py: <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#306998\" strokeWidth=\"2\"><path d=\"M12 2l-8 4v8l8 4 8-4V6zM12 17v-5h5M12 12h-5\" /></svg>,\n    // Default Icon\n    default: <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\"><path d=\"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2zM14 2v6h6\" /></svg>\n  }\n\n  return iconMap[ext || \"\"] || iconMap.default\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1630, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/components/CodeEditor.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"codeArea\": \"CodeEditor-module__IDUJ-W__codeArea\",\n  \"codeBlock\": \"CodeEditor-module__IDUJ-W__codeBlock\",\n  \"codeBlocks\": \"CodeEditor-module__IDUJ-W__codeBlocks\",\n  \"container\": \"CodeEditor-module__IDUJ-W__container\",\n  \"copyButton\": \"CodeEditor-module__IDUJ-W__copyButton\",\n  \"editorContent\": \"CodeEditor-module__IDUJ-W__editorContent\",\n  \"empty\": \"CodeEditor-module__IDUJ-W__empty\",\n  \"fileHeader\": \"CodeEditor-module__IDUJ-W__fileHeader\",\n  \"fileIndex\": \"CodeEditor-module__IDUJ-W__fileIndex\",\n  \"filePath\": \"CodeEditor-module__IDUJ-W__filePath\",\n  \"header\": \"CodeEditor-module__IDUJ-W__header\",\n  \"headerLeft\": \"CodeEditor-module__IDUJ-W__headerLeft\",\n  \"headerRight\": \"CodeEditor-module__IDUJ-W__headerRight\",\n  \"loading\": \"CodeEditor-module__IDUJ-W__loading\",\n  \"saveButton\": \"CodeEditor-module__IDUJ-W__saveButton\",\n  \"spin\": \"CodeEditor-module__IDUJ-W__spin\",\n  \"spinner\": \"CodeEditor-module__IDUJ-W__spinner\",\n  \"title\": \"CodeEditor-module__IDUJ-W__title\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 1654, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/abhig/Downloads/zip-explorer1/components/CodeEditor.tsx"],"sourcesContent":["// CodeEditor.tsx\n\n\"use client\"\n\nimport { useEffect, useRef, useState, useCallback } from \"react\"\nimport { toast } from \"sonner\"\nimport styles from \"./CodeEditor.module.css\"\n\ninterface EditorFile {\n  path: string\n  content: string\n}\n\ninterface CodeEditorProps {\n  files: EditorFile[]\n  isLoading: boolean\n  sessionId: string\n  userTier: \"anonymous\" | \"free\" | \"monthly\" | \"yearly\"\n}\n\nexport function CodeEditor({ files, isLoading, sessionId, userTier }: CodeEditorProps) {\n  const editorRef = useRef<HTMLDivElement>(null)\n  const [prismReady, setPrismReady] = useState(false)\n  // State to hold editable content. Key is file.path, value is the content string.\n  const [editableContent, setEditableContent] = useState<Record<string, string>>({})\n    \n    // Refs for cursor preservation\n    const focusedPath = useRef<string | null>(null) // Tracks the path of the currently focused <pre>\n  const cursorOffsets = useRef<Map<string, number | null>>(new Map()) // Stores caret offset for each path\n    const scrollPositions = useRef<Map<string, { top: number, left: number }>>(new Map()); // Stores scroll position\n\n    // --- Cursor Preservation Utility Functions ---\n\n    /**\n     * Reads the caret position as a character offset from the start of the <pre> element's raw text content.\n     * This version accurately calculates the offset by traversing only text nodes up to the caret position.\n     */\n    const getCaretOffset = (element: HTMLElement | null): number => {\n        let offset = 0;\n        const selection = window.getSelection();\n\n        // Check if we are inside the element and have a valid selection\n        if (!element || !selection || selection.rangeCount === 0 || !element.contains(selection.anchorNode)) {\n             return offset;\n        }\n\n        const range = selection.getRangeAt(0);\n        let currentRange = document.createRange();\n        \n        // Clone the range from the start of the element to the end of the selection\n        currentRange.setStart(element, 0);\n        currentRange.setEnd(range.endContainer, range.endOffset);\n        \n        // Calculate the raw text length from the start of the element up to the caret.\n        // This handles cases where Prism wraps text in <span> elements.\n        const treeWalker = document.createTreeWalker(\n            element,\n            NodeFilter.SHOW_TEXT,\n            null, // Only 3 arguments are expected by document.createTreeWalker in modern environments.\n            // false // Removed the deprecated fourth argument to fix the TypeScript error.\n        );\n        \n        let currentNode: Node | null;\n        let foundNode = false;\n\n        // Iterate through all text nodes\n        while ((currentNode = treeWalker.nextNode())) {\n            if (currentNode === range.endContainer) {\n                // If this is the node containing the caret, add the offset within that node.\n                offset += range.endOffset;\n                foundNode = true;\n                break;\n            } else if (currentRange.intersectsNode(currentNode)) {\n                // If this node is before the caret, add its full text length to the offset.\n                offset += currentNode.textContent?.length || 0;\n            } else if (foundNode) {\n                // Stop traversing once the target node is found and processed\n                break;\n            }\n        }\n\n        return offset;\n    };\n    \n    /**\n     * Sets the caret position within the given element based on a character offset.\n     */\n    const setCaretOffset = (element: HTMLElement | null, offset: number): void => {\n        if (!element || offset === null) return;\n    \n        let totalOffset = 0;\n        let found = false;\n        \n        // Traverse all child nodes (including text nodes created by Prism)\n        const traverse = (node: Node) => {\n            if (found) return;\n    \n            if (node.nodeType === Node.TEXT_NODE) {\n                const nodeLength = node.textContent?.length || 0;\n                \n                if (totalOffset + nodeLength >= offset) {\n                    const finalOffset = offset - totalOffset;\n                    const range = document.createRange();\n                    const selection = window.getSelection();\n    \n                    try {\n                        range.setStart(node, finalOffset);\n                        range.collapse(true);\n    \n                        selection?.removeAllRanges();\n                        selection?.addRange(range);\n                        found = true;\n                    } catch (e) {\n                        console.error(\"Error setting caret range:\", e);\n                    }\n                    return;\n                }\n                totalOffset += nodeLength;\n            } else if (node.nodeType === Node.ELEMENT_NODE) {\n                // Traverse children of element nodes\n                for (let i = 0; i < node.childNodes.length; i++) {\n                    traverse(node.childNodes[i]);\n                }\n            }\n        };\n    \n        traverse(element);\n        \n        // Fallback: If not found, place cursor at the end.\n        if (!found) {\n            element.focus();\n            const selection = window.getSelection();\n            const range = document.createRange();\n            range.selectNodeContents(element);\n            range.collapse(false); // Collapse to the end\n            selection?.removeAllRanges();\n            selection?.addRange(range);\n        }\n    };\n    // --- End Cursor Preservation Utility Functions ---\n\n\n  // useEffect 1: Initialize editableContent state when 'files' prop changes\n  useEffect(() => {\n    const newContent: Record<string, string> = {}\n    files.forEach(file => {\n      // Only initialize if content for this path is missing or if files list changes completely\n      if (!editableContent[file.path] || files.length !== Object.keys(editableContent).length) {\n        newContent[file.path] = file.content\n      } else {\n        // Keep existing edited content if the file path is the same\n        newContent[file.path] = editableContent[file.path]\n      }\n    })\n    setEditableContent(newContent)\n  // We intentionally exclude editableContent from the dependency array to prevent infinite loops\n  // and manage updates via the handleInput method.\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [files]) \n\n\n  // useEffect 2: Load Prism libraries (as before)\n  useEffect(() => {\n    if (typeof window === \"undefined\") return\n    if ((window as any).Prism) {\n      setPrismReady(true)\n      return\n    }\n\n    const cssLink = document.createElement(\"link\")\n    cssLink.rel = \"stylesheet\"\n    cssLink.href = \"https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css\"\n    document.head.appendChild(cssLink)\n\n    const script = document.createElement(\"script\")\n    script.src = \"https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js\"\n    script.onload = () => {\n      const commonLanguages = [\"javascript\", \"typescript\", \"python\", \"bash\", \"json\", \"css\", \"markup\", \"markdown\"] // Added markdown\n      let loaded = 0\n\n      commonLanguages.forEach((lang) => {\n        const langScript = document.createElement(\"script\")\n        langScript.src = `https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-${lang}.min.js`\n        langScript.onload = () => {\n          loaded++\n          if (loaded === commonLanguages.length) {\n            setPrismReady(true)\n          }\n        }\n        langScript.onerror = () => {\n          loaded++\n          if (loaded === commonLanguages.length) {\n            setPrismReady(true)\n          }\n        }\n        document.head.appendChild(langScript)\n      })\n    }\n    script.onerror = () => {\n      console.warn(\"Failed to load Prism\")\n      setPrismReady(true)\n    }\n    document.head.appendChild(script)\n  }, [])\n\n  // useEffect 3: Apply syntax highlighting and restore cursor & scroll\n  useEffect(() => {\n    if (!prismReady || !editorRef.current || isLoading || files.length === 0) return\n    \n    // We need to wait briefly for the DOM to update after state changes\n    const timer = setTimeout(() => {\n      if ((window as any).Prism && editorRef.current) {\n        try {\n          const activePath = focusedPath.current\n          const pres = editorRef.current.querySelectorAll(`.${styles.codeArea}`);\n          let activePreElement: HTMLElement | null = null;\n\n          pres.forEach((pre) => {\n            // Highlight the content of the PRE element, which replaces innerHTML\n            (window as any).Prism.highlightElement(pre)\n                        \n                        // Identify the element that needs cursor and scroll restoration\n                        const prePath = pre.getAttribute('data-filepath');\n                        if (activePath && prePath === activePath) {\n                            activePreElement = pre as HTMLElement;\n                        }\n          })\n                    \n                    // Restore Cursor and Scroll Position after highlighting\n                    if (activePath && activePreElement) {\n                        // Cast to HTMLPreElement to ensure access to scroll properties\n                        const preElement = activePreElement as HTMLPreElement; \n\n                        const offset = cursorOffsets.current.get(activePath);\n                        if (offset !== undefined && offset !== null) {\n                            setCaretOffset(preElement, offset);\n                        }\n\n                        const scroll = scrollPositions.current.get(activePath);\n                        if (scroll) {\n                            preElement.scrollTop = scroll.top;\n                            preElement.scrollLeft = scroll.left;\n                        }\n                    }\n\n        } catch (e) {\n          console.warn(\"Prism highlighting error:\", e)\n        }\n      }\n    }, 100)\n    return () => clearTimeout(timer)\n  }, [files, isLoading, prismReady, editableContent])\n\n\n  // Handler to capture user input\n  const handleInput = useCallback((filePath: string, event: React.FormEvent<HTMLPreElement>) => {\n        // Explicitly cast to HTMLPreElement to guarantee scroll properties exist\n    const currentPreElement = event.currentTarget as HTMLPreElement;\n    \n        // 1. Save Scroll Position BEFORE state change\n        scrollPositions.current.set(filePath, {\n            top: currentPreElement.scrollTop,\n            left: currentPreElement.scrollLeft\n        });\n\n    // 2. Save Cursor Position BEFORE state change (DOM is still valid)\n    const offset = getCaretOffset(currentPreElement); \n    cursorOffsets.current.set(filePath, offset);\n\n    // 3. Update Content\n    const newContent = currentPreElement.innerText || \"\"\n    setEditableContent(prev => ({\n      ...prev,\n      [filePath]: newContent\n    }))\n  }, [])\n  \n    // Handlers for focus/blur to track the active editor\n    const handleFocus = useCallback((filePath: string) => {\n        focusedPath.current = filePath;\n    }, [])\n    \n    // We don't need a custom handleBlur since the restoration logic is in useEffect\n    const handleBlur = useCallback(() => {\n        // No operation needed.\n    }, [])\n  \n\n  // Update copyToClipboard to use edited content\n  const copyToClipboard = async () => {\n    // Create a list of the *current* content for selected files\n    const contentToCopy = files.map(f => ({\n      path: f.path,\n      content: editableContent[f.path] || f.content\n    }))\n    \n    const text = contentToCopy.map((f) => `${f.path}\\n\\n${f.content}`).join(\"\\n\\n\" + \"=\".repeat(80) + \"\\n\\n\")\n    // Fallback for document.execCommand('copy') in environments where navigator.clipboard might fail\n    try {\n      await navigator.clipboard.writeText(text)\n      toast.success(\"Copied to clipboard!\")\n    } catch {\n      // Fallback: create a temporary textarea for copying\n              const tempTextArea = document.createElement(\"textarea\");\n              tempTextArea.value = text;\n              document.body.appendChild(tempTextArea);\n              tempTextArea.select();\n              document.execCommand('copy');\n              document.body.removeChild(tempTextArea);\n      toast.success(\"Copied to clipboard! (Fallback)\")\n    }\n  }\n\n  // --- handleSave function removed as requested ---\n\n  return (\n    <div className={styles.container}>\n      <div className={styles.header}>\n        <div className={styles.headerLeft}>\n          <h2 className={styles.title}>\n            {files.length > 0 ? `${files.length} file(s) selected` : \"No files selected\"}\n          </h2>\n        </div>\n        <div className={styles.headerRight}>\n          {files.length > 0 && (\n            <>\n              <button className={styles.copyButton} onClick={copyToClipboard}>\n                Copy All Code\n              </button>\n              {/* Removed the Save Button conditional block:\n              {userTier !== \"anonymous\" && userTier !== \"free\" && (\n                <button className={styles.saveButton} onClick={handleSave}>\n                  üíæ Save\n                </button>\n              )}\n              */}\n            </>\n          )}\n        </div>\n      </div>\n\n      <div className={styles.editorContent} ref={editorRef}>\n        {isLoading ? (\n          <div className={styles.loading}>\n            <div className={styles.spinner} />\n            <p>Loading file...</p>\n          </div>\n        ) : files.length === 0 ? (\n          <div className={styles.empty}>\n            <p>Select files from the explorer to view their content</p>\n          </div>\n        ) : (\n          <div className={styles.codeBlocks}>\n            {files.map((file, index) => {\n              // Use the currently edited content from state\n              const content = editableContent[file.path] || file.content\n              const prismContent = content\n\n              return (\n              <div key={file.path} className={styles.codeBlock}>\n                <div className={styles.fileHeader}>\n                  <span className={styles.filePath}>{file.path}</span>\n                  <span className={styles.fileIndex}>{index + 1}</span>\n                </div>\n                \n                {/* The <pre> element for contentEditable. Prism will replace the innerHTML \n                                 on re-render, and the cursor/scroll preservation logic handles the state change.\n                                */}\n                <pre \n                  // Apply both language class for Prism and custom style class\n                  className={`${getLanguageClass(file.path)} ${styles.codeArea}`} \n                  contentEditable \n                                  spellCheck=\"true\"\n                                  data-filepath={file.path} // Required for identifying the element in useEffect\n                                  onFocus={() => handleFocus(file.path)} // Track focus\n                  onInput={(e) => handleInput(file.path, e)}\n                  // Initialize content with raw text. This is replaced by Prism's HTML on effect run.\n                  dangerouslySetInnerHTML={{ __html: prismContent }}\n                  // Accessibility attributes\n                  role=\"textbox\"\n                  aria-multiline=\"true\"\n                />\n              </div>\n            )})}\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\nfunction getLanguageClass(filepath: string): string {\n  const ext = filepath.split(\".\").pop()?.toLowerCase()\n  const languageMap: { [key: string]: string } = {\n    js: \"language-javascript\",\n    ts: \"language-typescript\",\n    tsx: \"language-typescript\",\n    jsx: \"language-javascript\",\n    py: \"language-python\",\n    json: \"language-json\",\n    css: \"language-css\",\n    html: \"language-markup\",\n    md: \"language-markdown\",\n  }\n  // Prism requires a language- prefix to identify the code block type\n  return languageMap[ext || \"\"] || \"language-text\"\n}"],"names":[],"mappings":"AAAA,iBAAiB;;;;;;AAIjB;AACA;AACA;AAJA;;;;;AAkBO,SAAS,WAAW,EAAE,KAAK,EAAE,SAAS,EAAE,SAAS,EAAE,QAAQ,EAAmB;IACnF,MAAM,YAAY,IAAA,+MAAM,EAAiB;IACzC,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAC7C,iFAAiF;IACjF,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAAyB,CAAC;IAE9E,+BAA+B;IAC/B,MAAM,cAAc,IAAA,+MAAM,EAAgB,MAAM,iDAAiD;;IACnG,MAAM,gBAAgB,IAAA,+MAAM,EAA6B,IAAI,OAAO,oCAAoC;;IACtG,MAAM,kBAAkB,IAAA,+MAAM,EAA6C,IAAI,QAAQ,yBAAyB;IAEhH,gDAAgD;IAEhD;;;KAGC,GACD,MAAM,iBAAiB,CAAC;QACpB,IAAI,SAAS;QACb,MAAM,YAAY,OAAO,YAAY;QAErC,gEAAgE;QAChE,IAAI,CAAC,WAAW,CAAC,aAAa,UAAU,UAAU,KAAK,KAAK,CAAC,QAAQ,QAAQ,CAAC,UAAU,UAAU,GAAG;YAChG,OAAO;QACZ;QAEA,MAAM,QAAQ,UAAU,UAAU,CAAC;QACnC,IAAI,eAAe,SAAS,WAAW;QAEvC,4EAA4E;QAC5E,aAAa,QAAQ,CAAC,SAAS;QAC/B,aAAa,MAAM,CAAC,MAAM,YAAY,EAAE,MAAM,SAAS;QAEvD,+EAA+E;QAC/E,gEAAgE;QAChE,MAAM,aAAa,SAAS,gBAAgB,CACxC,SACA,WAAW,SAAS,EACpB;QAIJ,IAAI;QACJ,IAAI,YAAY;QAEhB,iCAAiC;QACjC,MAAQ,cAAc,WAAW,QAAQ,GAAK;YAC1C,IAAI,gBAAgB,MAAM,YAAY,EAAE;gBACpC,6EAA6E;gBAC7E,UAAU,MAAM,SAAS;gBACzB,YAAY;gBACZ;YACJ,OAAO,IAAI,aAAa,cAAc,CAAC,cAAc;gBACjD,4EAA4E;gBAC5E,UAAU,YAAY,WAAW,EAAE,UAAU;YACjD,OAAO,IAAI,WAAW;gBAElB;YACJ;QACJ;QAEA,OAAO;IACX;IAEA;;KAEC,GACD,MAAM,iBAAiB,CAAC,SAA6B;QACjD,IAAI,CAAC,WAAW,WAAW,MAAM;QAEjC,IAAI,cAAc;QAClB,IAAI,QAAQ;QAEZ,mEAAmE;QACnE,MAAM,WAAW,CAAC;YACd,IAAI,OAAO;YAEX,IAAI,KAAK,QAAQ,KAAK,KAAK,SAAS,EAAE;gBAClC,MAAM,aAAa,KAAK,WAAW,EAAE,UAAU;gBAE/C,IAAI,cAAc,cAAc,QAAQ;oBACpC,MAAM,cAAc,SAAS;oBAC7B,MAAM,QAAQ,SAAS,WAAW;oBAClC,MAAM,YAAY,OAAO,YAAY;oBAErC,IAAI;wBACA,MAAM,QAAQ,CAAC,MAAM;wBACrB,MAAM,QAAQ,CAAC;wBAEf,WAAW;wBACX,WAAW,SAAS;wBACpB,QAAQ;oBACZ,EAAE,OAAO,GAAG;wBACR,QAAQ,KAAK,CAAC,8BAA8B;oBAChD;oBACA;gBACJ;gBACA,eAAe;YACnB,OAAO,IAAI,KAAK,QAAQ,KAAK,KAAK,YAAY,EAAE;gBAC5C,qCAAqC;gBACrC,IAAK,IAAI,IAAI,GAAG,IAAI,KAAK,UAAU,CAAC,MAAM,EAAE,IAAK;oBAC7C,SAAS,KAAK,UAAU,CAAC,EAAE;gBAC/B;YACJ;QACJ;QAEA,SAAS;QAET,mDAAmD;QACnD,IAAI,CAAC,OAAO;YACR,QAAQ,KAAK;YACb,MAAM,YAAY,OAAO,YAAY;YACrC,MAAM,QAAQ,SAAS,WAAW;YAClC,MAAM,kBAAkB,CAAC;YACzB,MAAM,QAAQ,CAAC,QAAQ,sBAAsB;YAC7C,WAAW;YACX,WAAW,SAAS;QACxB;IACJ;IACA,oDAAoD;IAGtD,0EAA0E;IAC1E,IAAA,kNAAS,EAAC;QACR,MAAM,aAAqC,CAAC;QAC5C,MAAM,OAAO,CAAC,CAAA;YACZ,0FAA0F;YAC1F,IAAI,CAAC,eAAe,CAAC,KAAK,IAAI,CAAC,IAAI,MAAM,MAAM,KAAK,OAAO,IAAI,CAAC,iBAAiB,MAAM,EAAE;gBACvF,UAAU,CAAC,KAAK,IAAI,CAAC,GAAG,KAAK,OAAO;YACtC,OAAO;gBACL,4DAA4D;gBAC5D,UAAU,CAAC,KAAK,IAAI,CAAC,GAAG,eAAe,CAAC,KAAK,IAAI,CAAC;YACpD;QACF;QACA,mBAAmB;IACrB,+FAA+F;IAC/F,iDAAiD;IACjD,uDAAuD;IACvD,GAAG;QAAC;KAAM;IAGV,gDAAgD;IAChD,IAAA,kNAAS,EAAC;QACR,wCAAmC;;;QAMnC,MAAM;QAKN,MAAM;IA6BR,GAAG,EAAE;IAEL,qEAAqE;IACrE,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,cAAc,CAAC,UAAU,OAAO,IAAI,aAAa,MAAM,MAAM,KAAK,GAAG;QAE1E,oEAAoE;QACpE,MAAM,QAAQ,WAAW;YACvB,IAAI,AAAC,OAAe,KAAK,IAAI,UAAU,OAAO,EAAE;gBAC9C,IAAI;oBACF,MAAM,aAAa,YAAY,OAAO;oBACtC,MAAM,OAAO,UAAU,OAAO,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,+IAAM,CAAC,QAAQ,EAAE;oBACrE,IAAI,mBAAuC;oBAE3C,KAAK,OAAO,CAAC,CAAC;wBACZ,qEAAqE;wBACpE,OAAe,KAAK,CAAC,gBAAgB,CAAC;wBAE3B,gEAAgE;wBAChE,MAAM,UAAU,IAAI,YAAY,CAAC;wBACjC,IAAI,cAAc,YAAY,YAAY;4BACtC,mBAAmB;wBACvB;oBACd;oBAEU,wDAAwD;oBACxD,IAAI,cAAc,kBAAkB;wBAChC,+DAA+D;wBAC/D,MAAM,aAAa;wBAEnB,MAAM,SAAS,cAAc,OAAO,CAAC,GAAG,CAAC;wBACzC,IAAI,WAAW,aAAa,WAAW,MAAM;4BACzC,eAAe,YAAY;wBAC/B;wBAEA,MAAM,SAAS,gBAAgB,OAAO,CAAC,GAAG,CAAC;wBAC3C,IAAI,QAAQ;4BACR,WAAW,SAAS,GAAG,OAAO,GAAG;4BACjC,WAAW,UAAU,GAAG,OAAO,IAAI;wBACvC;oBACJ;gBAEZ,EAAE,OAAO,GAAG;oBACV,QAAQ,IAAI,CAAC,6BAA6B;gBAC5C;YACF;QACF,GAAG;QACH,OAAO,IAAM,aAAa;IAC5B,GAAG;QAAC;QAAO;QAAW;QAAY;KAAgB;IAGlD,gCAAgC;IAChC,MAAM,cAAc,IAAA,oNAAW,EAAC,CAAC,UAAkB;QAC7C,yEAAyE;QAC7E,MAAM,oBAAoB,MAAM,aAAa;QAEzC,8CAA8C;QAC9C,gBAAgB,OAAO,CAAC,GAAG,CAAC,UAAU;YAClC,KAAK,kBAAkB,SAAS;YAChC,MAAM,kBAAkB,UAAU;QACtC;QAEJ,mEAAmE;QACnE,MAAM,SAAS,eAAe;QAC9B,cAAc,OAAO,CAAC,GAAG,CAAC,UAAU;QAEpC,oBAAoB;QACpB,MAAM,aAAa,kBAAkB,SAAS,IAAI;QAClD,mBAAmB,CAAA,OAAQ,CAAC;gBAC1B,GAAG,IAAI;gBACP,CAAC,SAAS,EAAE;YACd,CAAC;IACH,GAAG,EAAE;IAEH,qDAAqD;IACrD,MAAM,cAAc,IAAA,oNAAW,EAAC,CAAC;QAC7B,YAAY,OAAO,GAAG;IAC1B,GAAG,EAAE;IAEL,gFAAgF;IAChF,MAAM,aAAa,IAAA,oNAAW,EAAC;IAC3B,uBAAuB;IAC3B,GAAG,EAAE;IAGP,+CAA+C;IAC/C,MAAM,kBAAkB;QACtB,4DAA4D;QAC5D,MAAM,gBAAgB,MAAM,GAAG,CAAC,CAAA,IAAK,CAAC;gBACpC,MAAM,EAAE,IAAI;gBACZ,SAAS,eAAe,CAAC,EAAE,IAAI,CAAC,IAAI,EAAE,OAAO;YAC/C,CAAC;QAED,MAAM,OAAO,cAAc,GAAG,CAAC,CAAC,IAAM,GAAG,EAAE,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO,EAAE,EAAE,IAAI,CAAC,SAAS,IAAI,MAAM,CAAC,MAAM;QAClG,iGAAiG;QACjG,IAAI;YACF,MAAM,UAAU,SAAS,CAAC,SAAS,CAAC;YACpC,iJAAK,CAAC,OAAO,CAAC;QAChB,EAAE,OAAM;YACN,oDAAoD;YAC5C,MAAM,eAAe,SAAS,aAAa,CAAC;YAC5C,aAAa,KAAK,GAAG;YACrB,SAAS,IAAI,CAAC,WAAW,CAAC;YAC1B,aAAa,MAAM;YACnB,SAAS,WAAW,CAAC;YACrB,SAAS,IAAI,CAAC,WAAW,CAAC;YAClC,iJAAK,CAAC,OAAO,CAAC;QAChB;IACF;IAEA,mDAAmD;IAEnD,qBACE,8OAAC;QAAI,WAAW,+IAAM,CAAC,SAAS;;0BAC9B,8OAAC;gBAAI,WAAW,+IAAM,CAAC,MAAM;;kCAC3B,8OAAC;wBAAI,WAAW,+IAAM,CAAC,UAAU;kCAC/B,cAAA,8OAAC;4BAAG,WAAW,+IAAM,CAAC,KAAK;sCACxB,MAAM,MAAM,GAAG,IAAI,GAAG,MAAM,MAAM,CAAC,iBAAiB,CAAC,GAAG;;;;;;;;;;;kCAG7D,8OAAC;wBAAI,WAAW,+IAAM,CAAC,WAAW;kCAC/B,MAAM,MAAM,GAAG,mBACd;sCACE,cAAA,8OAAC;gCAAO,WAAW,+IAAM,CAAC,UAAU;gCAAE,SAAS;0CAAiB;;;;;;;;;;;;;;;;;;0BAexE,8OAAC;gBAAI,WAAW,+IAAM,CAAC,aAAa;gBAAE,KAAK;0BACxC,0BACC,8OAAC;oBAAI,WAAW,+IAAM,CAAC,OAAO;;sCAC5B,8OAAC;4BAAI,WAAW,+IAAM,CAAC,OAAO;;;;;;sCAC9B,8OAAC;sCAAE;;;;;;;;;;;2BAEH,MAAM,MAAM,KAAK,kBACnB,8OAAC;oBAAI,WAAW,+IAAM,CAAC,KAAK;8BAC1B,cAAA,8OAAC;kCAAE;;;;;;;;;;yCAGL,8OAAC;oBAAI,WAAW,+IAAM,CAAC,UAAU;8BAC9B,MAAM,GAAG,CAAC,CAAC,MAAM;wBAChB,8CAA8C;wBAC9C,MAAM,UAAU,eAAe,CAAC,KAAK,IAAI,CAAC,IAAI,KAAK,OAAO;wBAC1D,MAAM,eAAe;wBAErB,qBACA,8OAAC;4BAAoB,WAAW,+IAAM,CAAC,SAAS;;8CAC9C,8OAAC;oCAAI,WAAW,+IAAM,CAAC,UAAU;;sDAC/B,8OAAC;4CAAK,WAAW,+IAAM,CAAC,QAAQ;sDAAG,KAAK,IAAI;;;;;;sDAC5C,8OAAC;4CAAK,WAAW,+IAAM,CAAC,SAAS;sDAAG,QAAQ;;;;;;;;;;;;8CAM9C,8OAAC;oCACC,6DAA6D;oCAC7D,WAAW,GAAG,iBAAiB,KAAK,IAAI,EAAE,CAAC,EAAE,+IAAM,CAAC,QAAQ,EAAE;oCAC9D,eAAe;oCACC,YAAW;oCACX,iBAAe,KAAK,IAAI;oCACxB,SAAS,IAAM,YAAY,KAAK,IAAI;oCACpD,SAAS,CAAC,IAAM,YAAY,KAAK,IAAI,EAAE;oCACvC,oFAAoF;oCACpF,yBAAyB;wCAAE,QAAQ;oCAAa;oCAChD,2BAA2B;oCAC3B,MAAK;oCACL,kBAAe;;;;;;;2BArBT,KAAK,IAAI;;;;;oBAwBpB;;;;;;;;;;;;;;;;;AAMb;AAEA,SAAS,iBAAiB,QAAgB;IACxC,MAAM,MAAM,SAAS,KAAK,CAAC,KAAK,GAAG,IAAI;IACvC,MAAM,cAAyC;QAC7C,IAAI;QACJ,IAAI;QACJ,KAAK;QACL,KAAK;QACL,IAAI;QACJ,MAAM;QACN,KAAK;QACL,MAAM;QACN,IAAI;IACN;IACA,oEAAoE;IACpE,OAAO,WAAW,CAAC,OAAO,GAAG,IAAI;AACnC"}},
    {"offset": {"line": 2067, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/abhig/Downloads/zip-explorer1/components/PricingNotice.tsx"],"sourcesContent":["export function PricingNotice() {\r\n  return (\r\n    <div\r\n      style={{\r\n        background: \"linear-gradient(135deg, #667eea 0%, #764ba2 100%)\",\r\n        color: \"white\",\r\n        padding: \"16px\",\r\n        textAlign: \"center\",\r\n        fontSize: \"14px\",\r\n        borderBottom: \"1px solid rgba(255,255,255,0.1)\",\r\n      }}\r\n    >\r\n      <strong>Anonymous users:</strong> Max 100 files per ZIP, no individual file downloads.\r\n      <a href=\"/login\" style={{ marginLeft: \"8px\", textDecoration: \"underline\" }}>\r\n        Sign in to unlock more features\r\n      </a>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAO,SAAS;IACd,qBACE,8OAAC;QACC,OAAO;YACL,YAAY;YACZ,OAAO;YACP,SAAS;YACT,WAAW;YACX,UAAU;YACV,cAAc;QAChB;;0BAEA,8OAAC;0BAAO;;;;;;YAAyB;0BACjC,8OAAC;gBAAE,MAAK;gBAAS,OAAO;oBAAE,YAAY;oBAAO,gBAAgB;gBAAY;0BAAG;;;;;;;;;;;;AAKlF"}},
    {"offset": {"line": 2114, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/components/ShareModal.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"closeBtn\": \"ShareModal-module__8VmaJa__closeBtn\",\n  \"copyBtn\": \"ShareModal-module__8VmaJa__copyBtn\",\n  \"fileItem\": \"ShareModal-module__8VmaJa__fileItem\",\n  \"fileList\": \"ShareModal-module__8VmaJa__fileList\",\n  \"generateBtn\": \"ShareModal-module__8VmaJa__generateBtn\",\n  \"generateSection\": \"ShareModal-module__8VmaJa__generateSection\",\n  \"info\": \"ShareModal-module__8VmaJa__info\",\n  \"label\": \"ShareModal-module__8VmaJa__label\",\n  \"modal\": \"ShareModal-module__8VmaJa__modal\",\n  \"modalBody\": \"ShareModal-module__8VmaJa__modalBody\",\n  \"modalContent\": \"ShareModal-module__8VmaJa__modalContent\",\n  \"modalHeader\": \"ShareModal-module__8VmaJa__modalHeader\",\n  \"newPinBtn\": \"ShareModal-module__8VmaJa__newPinBtn\",\n  \"pin\": \"ShareModal-module__8VmaJa__pin\",\n  \"pinBox\": \"ShareModal-module__8VmaJa__pinBox\",\n  \"pinDisplay\": \"ShareModal-module__8VmaJa__pinDisplay\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 2136, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/abhig/Downloads/zip-explorer1/components/ShareModal.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useState } from \"react\"\r\nimport { toast } from \"sonner\"\r\nimport styles from \"./ShareModal.module.css\"\r\n\r\n// Define a type for the file structure expected by the server\r\ninterface FileToShare {\r\n  path: string\r\n  name: string\r\n  content: string // The content of the file is required by the server API\r\n}\r\n\r\ninterface ShareModalProps {\r\n  isOpen: boolean\r\n  onClose: () => void\r\n  selectedFilePaths: string[]\r\n  // Assuming a function or context hook exists to fetch file content based on path\r\n  getFileContent: (path: string) => { name: string, content: string } | null; \r\n  onShareComplete?: (pin: string) => void\r\n}\r\n\r\nexport function ShareModal({ isOpen, onClose, selectedFilePaths, getFileContent }: ShareModalProps) {\r\n  const [pin, setPin] = useState<string | null>(null)\r\n  const [isGenerating, setIsGenerating] = useState(false)\r\n  const [copied, setCopied] = useState(false)\r\n\r\n  const handleGeneratePin = async () => {\r\n    if (selectedFilePaths.length === 0) {\r\n      toast.error(\"Select files to share\")\r\n      return\r\n    }\r\n\r\n    setIsGenerating(true)\r\n    \r\n    // --- START: FIX FOR 400 BAD REQUEST ---\r\n    \r\n    // 1. Prepare the files array with full content objects\r\n    const filesToSend: FileToShare[] = []\r\n    \r\n    for (const path of selectedFilePaths) {\r\n        // *** ASSUMPTION & TEMPORARY FIX ***\r\n        // Replace the mock function below with your actual logic to fetch file data \r\n        // from your file system state/context using the path.\r\n        \r\n        // This is a placeholder for demonstration:\r\n        const fileData = {\r\n             name: path.split('/').pop() || 'file',\r\n             content: `// Placeholder content for ${path}`, // <--- !!! This must be real content !!!\r\n        };\r\n        \r\n        // If you have a prop like getFileContent:\r\n        // const fileData = getFileContent(path);\r\n\r\n        if (fileData) {\r\n            filesToSend.push({\r\n                path: path,\r\n                name: fileData.name,\r\n                content: fileData.content,\r\n            });\r\n        }\r\n    }\r\n    \r\n    if (filesToSend.length === 0) {\r\n        toast.error(\"Could not retrieve content for selected files.\")\r\n        setIsGenerating(false)\r\n        return\r\n    }\r\n    // --- END: FIX FOR 400 BAD REQUEST ---\r\n\r\n    try {\r\n      const response = await fetch(\"/api/share/generate-pin\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        // Send the array of full file objects instead of just paths\r\n        body: JSON.stringify({ files: filesToSend }), \r\n      })\r\n\r\n      const data = await response.json()\r\n      if (!response.ok) {\r\n        // The server will now return a 400 if filesToSend is empty or invalid\r\n        toast.error(data.error || \"Failed to generate PIN\")\r\n        return\r\n      }\r\n\r\n      setPin(data.pin)\r\n      toast.success(\"PIN generated! Valid for 7 days.\")\r\n    } catch (error) {\r\n      toast.error(\"Failed to generate PIN\")\r\n    } finally {\r\n      setIsGenerating(false)\r\n    }\r\n  }\r\n\r\n  const handleCopyPin = () => {\r\n    if (pin) {\r\n      // Use execCommand for broader compatibility in some environments\r\n      try {\r\n        const tempTextArea = document.createElement('textarea');\r\n        tempTextArea.value = pin;\r\n        document.body.appendChild(tempTextArea);\r\n        tempTextArea.select();\r\n        document.execCommand('copy');\r\n        document.body.removeChild(tempTextArea);\r\n        setCopied(true);\r\n        setTimeout(() => setCopied(false), 2000);\r\n      } catch (err) {\r\n        toast.error(\"Failed to copy PIN to clipboard.\");\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!isOpen) return null\r\n\r\n  return (\r\n    <div className={styles.modal} onClick={onClose}>\r\n      <div className={styles.modalContent} onClick={(e) => e.stopPropagation()}>\r\n        <div className={styles.modalHeader}>\r\n          <h2>Share Files</h2>\r\n          <button onClick={onClose} className={styles.closeBtn}>\r\n            √ó\r\n          </button>\r\n        </div>\r\n\r\n        <div className={styles.modalBody}>\r\n          {pin ? (\r\n            <div className={styles.pinDisplay}>\r\n              <p className={styles.label}>Your Share PIN:</p>\r\n              <div className={styles.pinBox}>\r\n                <span className={styles.pin}>{pin}</span>\r\n                <button className={styles.copyBtn} onClick={handleCopyPin}>\r\n                  {copied ? \"‚úì Copied!\" : \"Copy\"}\r\n                </button>\r\n              </div>\r\n              <p className={styles.info}>Share this PIN with others to let them access your files. Valid for 7 days.</p>\r\n              <button className={styles.newPinBtn} onClick={() => setPin(null)}>\r\n                Generate New PIN\r\n              </button>\r\n            </div>\r\n          ) : (\r\n            <div className={styles.generateSection}>\r\n              <p className={styles.label}>Selected files: {selectedFilePaths.length}</p>\r\n              <div className={styles.fileList}>\r\n                {selectedFilePaths.slice(0, 5).map((file) => (\r\n                  <div key={file} className={styles.fileItem}>\r\n                    {file.split(\"/\").pop()}\r\n                  </div>\r\n                ))}\r\n                {selectedFilePaths.length > 5 && (\r\n                  <div className={styles.fileItem}>+{selectedFilePaths.length - 5} more</div>\r\n                )}\r\n              </div>\r\n              <button\r\n                className={styles.generateBtn}\r\n                onClick={handleGeneratePin}\r\n                disabled={isGenerating || selectedFilePaths.length === 0}\r\n              >\r\n                {isGenerating ? \"Generating...\" : \"Generate Share PIN\"}\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2402, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/components/AccessSharedFiles.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"accessBtn\": \"AccessSharedFiles-module__bqgaga__accessBtn\",\n  \"closeBtn\": \"AccessSharedFiles-module__bqgaga__closeBtn\",\n  \"downloadBtn\": \"AccessSharedFiles-module__bqgaga__downloadBtn\",\n  \"fileItem\": \"AccessSharedFiles-module__bqgaga__fileItem\",\n  \"fileList\": \"AccessSharedFiles-module__bqgaga__fileList\",\n  \"filesDisplay\": \"AccessSharedFiles-module__bqgaga__filesDisplay\",\n  \"input\": \"AccessSharedFiles-module__bqgaga__input\",\n  \"label\": \"AccessSharedFiles-module__bqgaga__label\",\n  \"modal\": \"AccessSharedFiles-module__bqgaga__modal\",\n  \"modalBody\": \"AccessSharedFiles-module__bqgaga__modalBody\",\n  \"modalContent\": \"AccessSharedFiles-module__bqgaga__modalContent\",\n  \"modalHeader\": \"AccessSharedFiles-module__bqgaga__modalHeader\",\n  \"newAccessBtn\": \"AccessSharedFiles-module__bqgaga__newAccessBtn\",\n  \"pinInput\": \"AccessSharedFiles-module__bqgaga__pinInput\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 2422, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/abhig/Downloads/zip-explorer1/components/AccessSharedFiles.tsx"],"sourcesContent":["// C:\\Users\\abhig\\Downloads\\zip-explorer1\\components\\AccessSharedFiles.tsx\r\n\r\n\"use client\"\r\n\r\nimport { useState } from \"react\"\r\nimport { toast } from \"sonner\"\r\n// Assuming this is the correct path to your style module\r\nimport styles from \"@/components/AccessSharedFiles.module.css\" \r\n\r\ninterface SharedFile {\r\n    path: string // This MUST be present and unique (e.g., \"src/index.js\")\r\n    content: string // Note: content is not used here but kept for interface consistency\r\n    name: string // This is the displayed filename (e.g., \"index.js\")\r\n}\r\n\r\ninterface AccessSharedFilesProps {\r\n    isOpen: boolean\r\n    onClose: () => void\r\n}\r\n\r\nexport function AccessSharedFiles({ isOpen, onClose }: AccessSharedFilesProps) {\r\n    const [pin, setPin] = useState(\"\")\r\n    const [files, setFiles] = useState<SharedFile[]>([])\r\n    const [isLoading, setIsLoading] = useState(false)\r\n    const [isDownloading, setIsDownloading] = useState(false)\r\n    const [accessed, setAccessed] = useState(false)\r\n\r\n    const handleAccessFiles = async () => {\r\n        if (!pin || !/^\\d{4}$/.test(pin)) {\r\n            toast.error(\"Invalid PIN format (4 digits)\")\r\n            return\r\n        }\r\n\r\n        setIsLoading(true)\r\n        try {\r\n            // 1. Fetch files associated with the PIN via the API route\r\n            const response = await fetch(\"/api/share/access\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                body: JSON.stringify({ pin }),\r\n            })\r\n\r\n            const data = await response.json()\r\n            if (!response.ok) {\r\n                // Handle specific expiration status (410) if the backend returns it\r\n                if (response.status === 410) {\r\n                    toast.error(\"The share PIN has expired.\")\r\n                } else {\r\n                    toast.error(data.error || \"Failed to access files\")\r\n                }\r\n                setFiles([]); // Ensure files state is reset on failure\r\n                return\r\n            }\r\n\r\n            // FIX: Ensure file objects have a valid path before setting state.\r\n            // The API route should provide { path: string, name: string }\r\n            const validFiles = data.files.filter((f: SharedFile) => f && f.path && f.name)\r\n            \r\n            setFiles(validFiles)\r\n            setAccessed(true)\r\n            \r\n            if (validFiles.length === 0) {\r\n                 // Warning if the share exists but contains no valid files\r\n                 toast.warning(\"Share accessed, but no files are available.\")\r\n            } else {\r\n                 toast.success(`Files accessed! Found ${validFiles.length} file(s).`)\r\n            }\r\n\r\n        } catch (error) {\r\n            console.error(\"Access Shared Files Error:\", error);\r\n            toast.error(\"Failed to access files due to an error.\")\r\n        } finally {\r\n            setIsLoading(false)\r\n        }\r\n    }\r\n\r\n    const handleDownloadShared = async () => {\r\n        if (!pin) {\r\n            toast.error(\"PIN is required for download.\")\r\n            return;\r\n        }\r\n        \r\n        const validFilePaths = files.map(f => f.path).filter(p => p && typeof p === 'string');\r\n\r\n        if (validFilePaths.length === 0) {\r\n            toast.error(\"No valid files to download.\")\r\n            return;\r\n        }\r\n\r\n        setIsDownloading(true);\r\n\r\n        try {\r\n            // 2. Call the dedicated API endpoint for PIN-based download\r\n            const response = await fetch(\"/api/share/download\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                // Pass the PIN and the list of paths to be zipped\r\n                body: JSON.stringify({ pin, files: validFilePaths }),\r\n            });\r\n\r\n            if (!response.ok) {\r\n                // The error response needs to be parsed if available\r\n                let errorData = { error: \"Download failed due to server error.\" };\r\n                try {\r\n                    errorData = await response.json();\r\n                } catch (e) {\r\n                    // response was not JSON, use generic message\r\n                }\r\n                toast.error(errorData.error || \"Download failed\")\r\n                return\r\n            }\r\n\r\n            // 3. Initiate client-side download from the blob response\r\n            const blob = await response.blob()\r\n            const url = window.URL.createObjectURL(blob)\r\n            const a = document.createElement(\"a\")\r\n            \r\n            a.href = url\r\n            a.download = \"shared_files.zip\" \r\n            \r\n            a.click()\r\n            window.URL.revokeObjectURL(url)\r\n            \r\n            toast.success(\"Download started!\")\r\n\r\n        } catch (error) {\r\n            console.error(\"Download shared files failed:\", error)\r\n            toast.error(\"Download failed due to client error.\")\r\n        } finally {\r\n            setIsDownloading(false);\r\n        }\r\n    }\r\n\r\n    if (!isOpen) return null\r\n\r\n    const fileCount = files.length;\r\n    // Updated text to reflect \"FILES AVAILABLE\" structure\r\n    const fileCountText = fileCount === 1 ? \"FILE AVAILABLE\" : \"FILES AVAILABLE\"; \r\n\r\n    return (\r\n        <div className={styles.modal} onClick={onClose}>\r\n            <div className={styles.modalContent} onClick={(e) => e.stopPropagation()}>\r\n                <div className={styles.modalHeader}>\r\n                    <h2>Access Shared Files</h2>\r\n                    <button onClick={onClose} className={styles.closeBtn}>\r\n                        √ó\r\n                    </button>\r\n                </div>\r\n\r\n                <div className={styles.modalBody}>\r\n                    {!accessed ? (\r\n                        <div className={styles.pinInput}>\r\n                            <label className={styles.label}>Enter Share PIN:</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                maxLength={4}\r\n                                placeholder=\"0000\"\r\n                                value={pin}\r\n                                // Only allow digits and limit length to 4\r\n                                onChange={(e) => setPin(e.target.value.replace(/\\D/g, \"\").slice(0, 4))}\r\n                                className={styles.input}\r\n                            />\r\n                            <button className={styles.accessBtn} onClick={handleAccessFiles} disabled={isLoading || pin.length !== 4}>\r\n                                {isLoading ? \"Accessing...\" : \"Access Files\"}\r\n                            </button>\r\n                        </div>\r\n                    ) : (\r\n                        <div className={styles.filesDisplay}>\r\n                            <p className={styles.label}>{fileCount} {fileCountText}</p>\r\n                            \r\n                            <div className={styles.fileList}>\r\n                                {fileCount > 0 ? (\r\n                                    files.map((file, index) => (\r\n                                        <div key={file.path || index} className={styles.fileItem}>\r\n                                            <span>{file.name}</span>\r\n                                        </div>\r\n                                    ))\r\n                                ) : (\r\n                                    <div className={styles.noFiles}>No files available in this share.</div>\r\n                                )}\r\n                            </div>\r\n                            \r\n                            <button \r\n                                className={styles.downloadBtn} \r\n                                onClick={handleDownloadShared} \r\n                                disabled={isDownloading || fileCount === 0}\r\n                            >\r\n                                {isDownloading ? \"‚¨áÔ∏è Preparing Download...\" : \"‚¨áÔ∏è Download All Files\"}\r\n                            </button>\r\n                            <button\r\n                                className={styles.newAccessBtn}\r\n                                onClick={() => {\r\n                                    setPin(\"\")\r\n                                    setFiles([])\r\n                                    setAccessed(false)\r\n                                }}\r\n                            >\r\n                                Access Another PIN\r\n                            </button>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2711, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/app/page.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"container\": \"page-module__E0kJGG__container\",\n  \"editor\": \"page-module__E0kJGG__editor\",\n  \"empty\": \"page-module__E0kJGG__empty\",\n  \"errorBanner\": \"page-module__E0kJGG__errorBanner\",\n  \"errorClose\": \"page-module__E0kJGG__errorClose\",\n  \"errorIcon\": \"page-module__E0kJGG__errorIcon\",\n  \"errorMessage\": \"page-module__E0kJGG__errorMessage\",\n  \"mainContent\": \"page-module__E0kJGG__mainContent\",\n  \"sidebar\": \"page-module__E0kJGG__sidebar\",\n  \"slideIn\": \"page-module__E0kJGG__slideIn\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 2727, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/abhig/Downloads/zip-explorer1/app/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useSession } from \"next-auth/react\"\nimport { useState, useCallback, useMemo } from \"react\"\nimport { TopBar } from \"@/components/TopBar\"\nimport { FileTree } from \"@/components/FileTree\"\nimport { CodeEditor } from \"@/components/CodeEditor\"\nimport { PricingNotice } from \"@/components/PricingNotice\"\nimport { ShareModal } from \"@/components/ShareModal\"\nimport { AccessSharedFiles } from \"@/components/AccessSharedFiles\"\nimport styles from \"./page.module.css\"\nimport type { FileNode } from \"@/app/actions\"\n\n\ninterface SelectedFile {\n\tpath: string\n\tcontent: string\n}\n\nexport default function Home() {\n\tconst { data: session } = useSession()\n\tconst [fileTree, setFileTree] = useState<FileNode | null>(null)\n\tconst [fileCount, setFileCount] = useState(0)\n\tconst [selectedFiles, setSelectedFiles] = useState<SelectedFile[]>([]) // This state holds the file data needed for saving\n\tconst [selectedFilePaths, setSelectedFilePaths] = useState<Set<string>>(new Set())\n\tconst [isLoading, setIsLoading] = useState(false)\n\tconst [error, setError] = useState<string | null>(null)\n\tconst [isLoadingFile, setIsLoadingFile] = useState(false)\n\tconst [sessionId, setSessionId] = useState<string>(\"\")\n\tconst [showShareModal, setShowShareModal] = useState(false)\n\tconst [showAccessShared, setShowAccessShared] = useState(false)\n\n\t// Determine userTier here for the PricingNotice and other components that need it\n\tconst userTier = session?.user?.subscriptionPlan || \"anonymous\"\n\t\n\t// Tier limits logic remains, used for upload checks (which are commented out but should exist)\n\tconst tierLimits = useMemo(\n\t\t() => ({\n\t\t\tanonymous: {\n\t\t\t\tmaxFilesPerZip: 100,\n\t\t\t\tcanDownloadIndividual: false,\n\t\t\t\tcanDownloadZip: false,\n\t\t\t},\n\t\t\tfree: {\n\t\t\t\tmaxFilesPerZip: 200,\n\t\t\t\tcanDownloadIndividual: true,\n\t\t\t\tcanDownloadZip: true,\n\t\t\t},\n\t\t\tmonthly: {\n\t\t\t\tmaxFilesPerZip: Number.POSITIVE_INFINITY,\n\t\t\t\tcanDownloadIndividual: true,\n\t\t\t\tcanDownloadZip: true,\n\t\t\t},\n\t\t\tyearly: {\n\t\t\t\tmaxFilesPerZip: Number.POSITIVE_INFINITY,\n\t\t\t\tcanDownloadIndividual: true,\n\t\t\t\tcanDownloadZip: true,\n\t\t\t},\n\t\t}),\n\t\t[],\n\t)\n\n\t/**\n\t * Memoized function to retrieve file content and name based on path.\n\t * This is required by ShareModal.tsx to send the full file object to the API.\n\t */\n\tconst getFileContent = useCallback(\n\t\t(path: string) => {\n\t\t\tconst file = selectedFiles.find((f) => f.path === path)\n\t\t\tif (file) {\n\t\t\t\t// We need to extract the name, as the selectedFiles array doesn't explicitly store it\n\t\t\t\tconst name = path.split(\"/\").pop() || \"\";\n\t\t\t\tif (name) {\n\t\t\t\t\treturn { name, content: file.content }\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null\n\t\t},\n\t\t[selectedFiles],\n\t)\n\n// New: Handler for loading files from a saved ZIP history\nconst handleLoadSavedZip = useCallback((loadedFiles: SelectedFile[]) => {\n  // Clear current state\n  setSelectedFiles([])\n  setSelectedFilePaths(new Set())\n\n  const fileMap: Record<string, string> = {}\n  loadedFiles.forEach(f => {\n    fileMap[f.path] = f.content\n  })\n\n  // Rebuild the file tree\n  const tree = buildFileTree(fileMap)\n\n  // Update state with loaded data\n  setFileTree(tree)\n  setFileCount(loadedFiles.length)\n  // IMPORTANT: Set the loaded files as the new content.\n  setSelectedFiles(loadedFiles); \n\n  // Since we load the whole ZIP, we should clear the session ID to start fresh, \n  // or retrieve a new one if necessary for API calls. For simplicity, we clear it here.\n  setSessionId(\"\"); \n}, [])\n\n\n\tconst handleUpload = useCallback(async (file: File) => {\n\t\tsetIsLoading(true)\n\t\tsetError(null)\n\t\tsetFileTree(null)\n\t\tsetSelectedFiles([])\n\t\tsetSelectedFilePaths(new Set())\n\n\n\t\ttry {\n\t\t\tconst formData = new FormData()\n\t\t\tformData.append(\"file\", file)\n\n\t\t\tconst result = await fetch(\"/api/zip/extract\", {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tbody: formData,\n\t\t\t})\n\n\t\t\tconst data = await result.json()\n\n\t\t\tif (!result.ok) {\n\t\t\t\tsetError(data.error || \"Failed to extract zip file\")\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// ‚≠ê FIX: Store ALL extracted file contents for saving later\n\t\t\tconst allFilesContent: SelectedFile[] = Object.entries(data.files).map(([path, content]) => ({\n\t\t\t\tpath,\n\t\t\t\tcontent: content as string,\n\t\t\t}))\n\t\t\tsetSelectedFiles(allFilesContent)\n\t\t\t\n\t\t\t// End of FIX\n\t\t\t\n\t\t\tsetFileTree(data.files ? buildFileTree(data.files) : null)\n\t\t\tsetFileCount(data.fileCount)\n\t\t\tsetSessionId(data.sessionId)\n\t\t} catch (err) {\n\t\t\tsetError(err instanceof Error ? err.message : \"An error occurred\")\n\t\t} finally {\n\t\t\tsetIsLoading(false)\n\t\t}\n\t}, [])\n\n\t// NOTE: handleFileSelect is now only responsible for tracking which files are open in the editor.\n\t// It no longer needs to fetch content if all content is loaded on upload.\n\t// However, your original implementation fetches file content on select. I'll preserve the fetch logic \n\t// but skip adding to `selectedFiles` if it's already present (since it's all loaded on upload now).\n\t// To avoid redundancy and fix the file count issue, I'll remove the content fetching logic from here\n\t// and assume `selectedFiles` contains all file content after `handleUpload`.\n\n\tconst handleFileSelect = useCallback(\n\t\t(filePath: string) => {\n\t\t\tconst isAlreadySelected = selectedFilePaths.has(filePath)\n\n\t\t\tif (isAlreadySelected) {\n\t\t\t\tsetSelectedFilePaths((prev) => {\n\t\t\t\t\tconst next = new Set(prev)\n\t\t\t\t\tnext.delete(filePath)\n\t\t\t\t\treturn next\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\t// We assume file content is already in `selectedFiles` from handleUpload.\n\t\t\t\t// We only update the list of paths for the CodeEditor to display.\n\t\t\t\tsetSelectedFilePaths((prev) => new Set([...prev, filePath]))\n\t\t\t}\n\t\t},\n\t\t[selectedFilePaths],\n\t)\n\n\treturn (\n\t\t<div className={styles.container}>\n\t\t\t<TopBar\n                fileCount={fileCount}\n                onUpload={handleUpload}\n                isLoading={isLoading}\n                selectedFilePaths={Array.from(selectedFilePaths)}\n                sessionId={sessionId}\n                onShareClick={() => setShowShareModal(true)}\n                onAccessSharedClick={() => setShowAccessShared(true)}\n                onLoadSavedZip={handleLoadSavedZip}\n                // ‚≠ê CORRECT: Pass the required 'files' prop from state (now containing ALL content)\n                files={selectedFiles} \n            />\n\n\n\t\t\t{error && (\n\t\t\t\t<div className={styles.errorBanner}>\n\t\t\t\t\t<span className={styles.errorIcon}>‚ö†Ô∏è</span>\n\t\t\t\t\t<span className={styles.errorMessage}>{error}</span>\n\t\t\t\t\t<button className={styles.errorClose} onClick={() => setError(null)} aria-label=\"Close error\">\n\t\t\t\t\t\t√ó\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{/* PricingNotice still needs the session check */}\n\t\t\t{!session && <PricingNotice />}\n\n\t\t\t<ShareModal\n\t\t\t\tisOpen={showShareModal}\n\t\t\t\tonClose={() => setShowShareModal(false)}\n\t\t\t\tselectedFilePaths={Array.from(selectedFilePaths)}\n\t\t\t\tgetFileContent={getFileContent} // <-- FIX: Passing the required prop\n\t\t\t/>\n\n\t\t\t<AccessSharedFiles isOpen={showAccessShared} onClose={() => setShowAccessShared(false)} />\n\n\t\t\t<div className={styles.mainContent}>\n\t\t\t\t<aside className={styles.sidebar}>\n\t\t\t\t\t{fileTree ? (\n\t\t\t\t\t\t<FileTree tree={fileTree} onFileSelect={handleFileSelect} selectedFiles={selectedFilePaths} />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className={styles.empty}>\n\t\t\t\t\t\t\t<p>Upload a .zip file to explore its contents</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</aside>\n\t\t\t\t<main className={styles.editor}>\n\t\t\t\t\t{/* Pass only the currently *selected* files to the editor */}\n\t\t\t\t\t<CodeEditor \n\t\t\t\t\t\tfiles={selectedFiles.filter(f => selectedFilePaths.has(f.path))} \n\t\t\t\t\t\tisLoading={isLoadingFile} \n\t\t\t\t\t\tsessionId={sessionId} \n\t\t\t\t\t\tuserTier={userTier} \n\t\t\t\t\t/>\n\t\t\t\t</main>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nfunction buildFileTree(files: Record<string, string>): FileNode {\n\tconst root: FileNode = {\n\t\tname: \"root\",\n\t\tpath: \".\",\n\t\ttype: \"folder\",\n\t\tchildren: [],\n\t}\n\n\tconst nodeMap = new Map<string, FileNode>()\n\tnodeMap.set(\".\", root)\n\n\tconst paths = Object.keys(files)\n\n\tfor (const filePath of paths) {\n\t\tconst parts = filePath.split(\"/\").filter((p) => p)\n\t\tfor (let i = 0; i < parts.length; i++) {\n\t\t\tconst fullPath = parts.slice(0, i + 1).join(\"/\")\n\t\t\tif (!nodeMap.has(fullPath)) {\n\t\t\t\tconst name = parts[i]\n\t\t\t\tconst isLast = i === parts.length - 1\n\t\t\t\tconst isDirectory = !isLast\n\t\t\t\tconst node: FileNode = {\n\t\t\t\t\tname,\n\t\t\t\t\tpath: fullPath,\n\t\t\t\t\ttype: isDirectory ? \"folder\" : \"file\",\n\t\t\t\t\t...(isDirectory && { children: [] }),\n\t\t\t\t}\n\t\t\t\tnodeMap.set(fullPath, node)\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (const [path, node] of nodeMap.entries()) {\n\t\tif (path === \".\") continue\n\t\tconst parentPath = path.substring(0, path.lastIndexOf(\"/\")) || \".\"\n\t\tconst parent = nodeMap.get(parentPath)\n\t\tif (parent && parent.type === \"folder\" && parent.children) {\n\t\t\tparent.children.push(node)\n\t\t}\n\t}\n\n\n\t\n\tconst sortNode = (node: FileNode) => {\n\t\tif (node.children) {\n\t\t\tnode.children.sort((a, b) => {\n\t\t\t\tif (a.type !== b.type) return a.type === \"folder\" ? -1 : 1\n\t\t\t\treturn a.name.localeCompare(b.name)\n\t\t\t})\n\t\t\tnode.children.forEach(sortNode)\n\t\t}\n\t}\n\n\tsortNode(root)\n\treturn root\n}"],"names":[],"mappings":"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"}}]
}